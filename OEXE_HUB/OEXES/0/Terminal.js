var Items;
Items.push({ Name: "JS Terminal", src: "", oexe: "eyJqcyI6W3siY29kZSI6IlxuXG5cbmZ1bmN0aW9uIGJyb3dzZXIoKSB7XG4gICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgIFwiaHR0cHM6Ly9nMWtrNC5jc2IuYXBwXCIsXG4gICAgICAgICAgXCJfYmxhbmtcIixcbiAgICAgICAgICBcInRvb2xiYXI9eWVzLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsdG9wPTUwMCxsZWZ0PTUwMCx3aWR0aD0xMDAwLGhlaWdodD01MDBcIlxuICAgICAgICApO1xufVxuXG5mdW5jdGlvbiBmcmFtZSh1cmwpXG4ge1xuICAgICAoZnVuY3Rpb24oKSB7XG4gIC8vIGNvbnRhaW5lclxuICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29udGFpbmVyLmlkID0gXCJsaW5rLXZpZXdlclwiO1xuXG4gIGNvbnRhaW5lci5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgY29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0ZGRlwiO1xuICBjb250YWluZXIuc3R5bGUud2lkdGggPSBcIjQwMHB4XCI7XG4gIGNvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSBcInNvbGlkIDFweCAjQUFBXCI7XG4gIGNvbnRhaW5lci5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjJweFwiO1xuICBjb250YWluZXIuc3R5bGUucG9zaXRpb24gPSBcImZpeGVkXCI7XG4gIGNvbnRhaW5lci5zdHlsZS50b3AgPSBcIjEwMHB4XCI7XG4gIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gXCIxMDBweFwiO1xuICBjb250YWluZXIuc3R5bGUuekluZGV4ID0gXCI5OTk5OTk5OTk5OTk5OTk5OTk5XCI7XG5cbiAgLy8gaUZyYW1lXG4gIHZhciBpRnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICBpRnJhbWUuaWQgPSBcImxpbmstdmlld2VyLWlmcmFtZVwiO1xuXG4gIGlGcmFtZS5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgaUZyYW1lLnN0eWxlLm1hcmdpbiA9IFwiMHB4XCI7XG4gIGlGcmFtZS5zdHlsZS53aWR0aCA9IGNvbnRhaW5lci5zdHlsZS53aWR0aDtcbiAgaUZyYW1lLmhlaWdodCA9IGlGcmFtZS5zdHlsZS5oZWlnaHQgPSBcIjIwMHB4XCI7XG4gIGlGcmFtZS5zdHlsZS5ib3JkZXIgPSBcIm5vbmVcIjtcbiAgaUZyYW1lLnNyYyA9IFwiZGF0YTp0ZXh0L2h0bWwsIDxoMSBzdHlsZT0nbWFyZ2luOiA0MHB4IDBweCAyMHB4IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LWZhbWlseTogc2Fucy1zZXJpZjsnPkVudGVyIGEgbGluayB0byBnZXQgc3RhcnRlZCE8L2gxPlwiO1xuXG4gIGlGcmFtZS5zdHlsZS5yZXNpemUgPSBcImJvdGhcIjtcbiAgaUZyYW1lLnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcblxuICAvLyBjb250ZW50IGhvbGRlclxuICB2YXIgY29udGVudEhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnRlbnRIb2xkZXIuaWQgPSBcImxpbmstdmlld2VyLWNvbnRlbnQtaG9sZGVyXCI7XG5cbiAgY29udGVudEhvbGRlci5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgY29udGVudEhvbGRlci5zdHlsZS53aWR0aCA9IFwiNDAwcHhcIjtcbiAgY29udGVudEhvbGRlci5zdHlsZS5oZWlnaHQgPSBpRnJhbWUuaGVpZ2h0O1xuICBjb250ZW50SG9sZGVyLnN0eWxlLnBhZGRpbmcgPSBcIjBweFwiO1xuICBjb250ZW50SG9sZGVyLnN0eWxlLm1hcmdpbiA9IFwiMHB4XCI7XG5cbiAgY29udGVudEhvbGRlci5hcHBlbmQoaUZyYW1lKTtcbiAgY29udGFpbmVyLmFwcGVuZChjb250ZW50SG9sZGVyKTtcblxuICAvLyBoZWFkZXJcbiAgdmFyIGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGhlYWRlci5pZCA9IFwibGluay12aWV3ZXItaGVhZGVyXCI7XG5cbiAgaGVhZGVyLnN0eWxlLmFsbCA9IFwidW5zZXRcIjtcblxuICBoZWFkZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuICBoZWFkZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSBcInNwYWNlLWJldHdlZW5cIjtcbiAgaGVhZGVyLnN0eWxlLmFsaWduSXRlbXMgPSBcImNlbnRlclwiO1xuICBoZWFkZXIuc3R5bGUudXNlclNlbGVjdCA9IFwibm9uZVwiO1xuICBoZWFkZXIuc3R5bGUucGFkZGluZyA9IFwiM3B4XCI7XG4gIGhlYWRlci5zdHlsZS5tYXJnaW4gPSBcIjBweFwiO1xuICBoZWFkZXIuc3R5bGUuYm9yZGVyQm90dG9tID0gXCJzb2xpZCAxcHggI0FBQVwiO1xuXG4gIGhlYWRlci5zdHlsZS5oZWlnaHQgPSBcIjIwcHhcIjtcbiAgaGVhZGVyLnN0eWxlLndpZHRoID0gTnVtYmVyKGNvbnRlbnRIb2xkZXIuc3R5bGUud2lkdGguc2xpY2UoMCwgLTIpIC0gNikgKyBcInB4XCI7XG5cbiAgdmFyIGRyYWdnZWQgPSBmYWxzZTtcbiAgdmFyIHN0YXJ0WCA9IDA7XG4gIHZhciBzdGFydFkgPSAwO1xuICBoZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIHN0YXJ0WCA9IE51bWJlcihjb250YWluZXIuc3R5bGUubGVmdC5zbGljZSgwLCAtMikpIC0gZXZlbnQuY2xpZW50WDtcbiAgICBzdGFydFkgPSBOdW1iZXIoY29udGFpbmVyLnN0eWxlLnRvcC5zbGljZSgwLCAtMikpIC0gZXZlbnQuY2xpZW50WTtcbiAgICBkcmFnZ2VkID0gdHJ1ZTtcbiAgfSk7XG4gIGhlYWRlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGRyYWdnZWQgPSBmYWxzZTtcbiAgfSk7XG5cbiAgLy8gQWxzbyBrZWVwaW5nIHRyYWNrIG9mIHNpemUgdG9vXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGRyYWdnZWQpIHtcbiAgICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSAoZXZlbnQuY2xpZW50WSArIHN0YXJ0WSkgKyBcInB4XCI7XG4gICAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IChldmVudC5jbGllbnRYICsgc3RhcnRYKSArIFwicHhcIjtcbiAgICB9XG4gICAgdmFyIHggPSBOdW1iZXIoY29udGFpbmVyLnN0eWxlLmxlZnQuc2xpY2UoMCwgLTIpKTtcbiAgICB2YXIgeSA9IE51bWJlcihjb250YWluZXIuc3R5bGUudG9wLnNsaWNlKDAsIC0yKSk7XG4gICAgaWYgKHggPCAwKSB7XG4gICAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgfVxuICAgIGlmICh5IDwgMCkge1xuICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IFwiMHB4XCI7XG4gICAgfVxuXG4gICAgY29udGVudEhvbGRlci5zdHlsZS5oZWlnaHQgPSBpRnJhbWUuc3R5bGUuaGVpZ2h0O1xuICAgIGNvbnRlbnRIb2xkZXIuc3R5bGUud2lkdGggPSBpRnJhbWUuc3R5bGUud2lkdGg7XG5cbiAgICBoZWFkZXIuc3R5bGUud2lkdGggPSAoTnVtYmVyKGNvbnRlbnRIb2xkZXIuc3R5bGUud2lkdGguc2xpY2UoMCwgLTIpKSAtIDYpICsgXCJweFwiO1xuXG4gICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gY29udGVudEhvbGRlci5zdHlsZS53aWR0aDtcbiAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gKE51bWJlcihjb250ZW50SG9sZGVyLnN0eWxlLmhlaWdodC5zbGljZSgwLCAtMikpICsgMjcpICsgXCJweFwiO1xuXG4gICAgaWYoTnVtYmVyKGhlYWRlci5zdHlsZS53aWR0aC5zbGljZSgwLCAtMikpIDwgMzAwKXtcbiAgICBjb250ZW50SG9sZGVyLnN0eWxlLndpZHRoID0gXCIzMDBweFwiO1xuICAgIGhlYWRlci5zdHlsZS53aWR0aCA9IFwiMjk0cHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBcIjMwMHB4XCI7XG4gICAgaUZyYW1lLnN0eWxlLndpZHRoID0gXCIzMDBweFwiO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gdGV4dCBzdHVmZlxuICB2YXIgaGVhZGVyVGV4dEhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgaGVhZGVyVGV4dEhvbGRlci5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgLy8gaGVhZGVyIHRleHRcbiAgdmFyIGhlYWRlclRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XG4gIGhlYWRlclRleHQudGV4dENvbnRlbnQgPSBcIkxpbmsgVmlld2VyXCI7XG5cbiAgaGVhZGVyVGV4dC5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgaGVhZGVyVGV4dC5zdHlsZS5mb250RmFtaWx5ID0gXCJzYW5zLXNlcmlmXCI7XG4gIGhlYWRlclRleHQuc3R5bGUuY29sb3IgPSBcIiM0NDRcIjtcbiAgaGVhZGVyVGV4dC5zdHlsZS5mb250U2l6ZSA9IFwiMjBweFwiO1xuICBoZWFkZXJUZXh0LnN0eWxlLm1hcmdpbiA9IFwiMHB4XCI7XG4gIGhlYWRlclRleHQuc3R5bGUucGFkZGluZyA9IFwiMHB4XCI7XG5cbiAgaGVhZGVyVGV4dEhvbGRlci5hcHBlbmQoaGVhZGVyVGV4dCk7XG4gIGhlYWRlci5hcHBlbmQoaGVhZGVyVGV4dEhvbGRlcik7XG5cbiAgLy8gYnV0dG9uIHN0dWZmIFxuICB2YXIgaGVhZGVyQnV0dG9uSG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICBoZWFkZXJCdXR0b25Ib2xkZXIuc3R5bGUuYWxsID0gXCJ1bnNldFwiO1xuXG4gIC8vIGxpbmsgYnV0dG9uXG4gIHZhciBsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgbEJ1dHRvbi50ZXh0Q29udGVudCA9IFwicnVuIHVybFwiO1xuXG4gIGxCdXR0b24uc3R5bGUuYWxsID0gXCJ1bnNldFwiO1xuXG4gIGxCdXR0b24uc3R5bGUuZm9udEZhbWlseSA9IFwic2Fucy1zZXJpZlwiO1xuICBsQnV0dG9uLnN0eWxlLndpZHRoID0gXCIxMDBweFwiO1xuICBsQnV0dG9uLnN0eWxlLmhlaWdodCA9IFwiMjBweFwiO1xuICBsQnV0dG9uLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuICBsQnV0dG9uLnN0eWxlLm1hcmdpbiA9IFwiMHB4IDNweCAwcHggM3B4XCI7XG4gIGxCdXR0b24uc3R5bGUuY29sb3IgPSBcIiMzMzNcIjtcbiAgbEJ1dHRvbi5zdHlsZS5ib3JkZXIgPSBcInNvbGlkIDFweCAjMzMzXCI7XG4gIGxCdXR0b24uc3R5bGUuYm9yZGVyUmFkaXVzID0gXCIycHhcIjtcbiAgbEJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNFRUVcIjtcbiAgbEJ1dHRvbi5zdHlsZS50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuXG4gIGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGxCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjREREXCI7XG4gIH0pO1xuICBsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgbEJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNFRUVcIjtcbiAgfSk7XG4gIGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICBcblxuICAgIGlGcmFtZS5zcmMgPSB1cmw7XG4gIH0pO1xuXG4gIGhlYWRlckJ1dHRvbkhvbGRlci5hcHBlbmQobEJ1dHRvbik7XG5cbiAgLy8gbWluaW1pemUgYnV0dG9uXG4gIHZhciBtQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgbUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiLVwiO1xuXG4gIG1CdXR0b24uc3R5bGUuYWxsID0gXCJ1bnNldFwiO1xuXG4gIG1CdXR0b24uc3R5bGUuZm9udEZhbWlseSA9IFwic2Fucy1zZXJpZlwiO1xuICBtQnV0dG9uLnN0eWxlLndpZHRoID0gXCIyMHB4XCI7XG4gIG1CdXR0b24uc3R5bGUuaGVpZ2h0ID0gXCIyMHB4XCI7XG4gIG1CdXR0b24uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gIG1CdXR0b24uc3R5bGUubWFyZ2luID0gXCIwcHggM3B4IDBweCAzcHhcIjtcbiAgbUJ1dHRvbi5zdHlsZS5jb2xvciA9IFwiIzMzM1wiO1xuICBtQnV0dG9uLnN0eWxlLmJvcmRlciA9IFwic29saWQgMXB4ICMzMzNcIjtcbiAgbUJ1dHRvbi5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjJweFwiO1xuICBtQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0VFRVwiO1xuICBtQnV0dG9uLnN0eWxlLnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XG5cbiAgbUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgbUJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNERERcIjtcbiAgfSk7XG4gIG1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBtQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0VFRVwiO1xuICB9KTtcbiAgbUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgY2xvc2VkID0gY29udGVudEhvbGRlci5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIjtcbiAgICBpZiAoY2xvc2VkKSB7XG4gICAgICBjb250ZW50SG9sZGVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICBoZWFkZXIuc3R5bGUuYm9yZGVyQm90dG9tID0gXCJzb2xpZCAxcHggI0FBQVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZW50SG9sZGVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgIGhlYWRlci5zdHlsZS5ib3JkZXJCb3R0b20gPSBcIm5vbmVcIjtcbiAgICB9XG4gIH0pO1xuXG4gIGhlYWRlckJ1dHRvbkhvbGRlci5hcHBlbmQobUJ1dHRvbik7XG5cbiAgLy8geCBidXR0b25cbiAgdmFyIHhCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICB4QnV0dG9uLnRleHRDb250ZW50ID0gXCJ4XCI7XG5cbiAgeEJ1dHRvbi5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgeEJ1dHRvbi5zdHlsZS5mb250RmFtaWx5ID0gXCJzYW5zLXNlcmlmXCI7XG4gIHhCdXR0b24uc3R5bGUud2lkdGggPSBcIjIwcHhcIjtcbiAgeEJ1dHRvbi5zdHlsZS5oZWlnaHQgPSBcIjIwcHhcIjtcbiAgeEJ1dHRvbi5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcbiAgeEJ1dHRvbi5zdHlsZS5tYXJnaW4gPSBcIjBweCAzcHggMHB4IDNweFwiO1xuICB4QnV0dG9uLnN0eWxlLmNvbG9yID0gXCIjMzMzXCI7XG4gIHhCdXR0b24uc3R5bGUuYm9yZGVyID0gXCJzb2xpZCAxcHggIzMzM1wiO1xuICB4QnV0dG9uLnN0eWxlLmJvcmRlclJhZGl1cyA9IFwiMnB4XCI7XG4gIHhCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjRjMzXCI7XG4gIHhCdXR0b24uc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcblxuICB4QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB4QnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0UyMlwiO1xuICB9KTtcbiAgeEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIHhCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjRjMzXCI7XG4gIH0pO1xuICB4QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnRhaW5lci5yZW1vdmUoKTtcbiAgfSk7XG5cbiAgaGVhZGVyQnV0dG9uSG9sZGVyLmFwcGVuZCh4QnV0dG9uKTtcbiAgaGVhZGVyLmFwcGVuZChoZWFkZXJCdXR0b25Ib2xkZXIpO1xuXG4gIGNvbnRlbnRIb2xkZXIuYmVmb3JlKGhlYWRlcik7XG5cbiAgLy8gYWRkIHRvIGJvZHlcbiAgZG9jdW1lbnQuYm9keSA9IGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJvZHlcIik7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kKGNvbnRhaW5lcik7XG59KSgpO1xuIH1cbnZhclxuaGlzdExpc3QgPSBbXCJcIl0sXG5oaXN0UG9zID0gMCxcbl9zY29wZSA9IHt9LFxuX3dpbiwgLy8gYSB0b3AtbGV2ZWwgY29udGV4dFxucXVlc3Rpb24sXG5faW4sXG5fb3V0LFxudG9vTWFueU1hdGNoZXMgPSBudWxsLFxubGFzdEVycm9yID0gbnVsbDtcblxuZnVuY3Rpb24gcmVmb2N1cygpXG57XG4gIF9pbi5ibHVyKCk7IC8vIE5lZWRlZCBmb3IgTW96aWxsYSB0byBzY3JvbGwgY29ycmVjdGx5LlxuICBfaW4uZm9jdXMoKTtcbn1cblxuZnVuY3Rpb24gaW5pdCgpXG57XG4gIF9pbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5wdXRcIik7XG4gIF9vdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm91dHB1dFwiKTtcblxuICBfd2luID0gd2luZG93O1xuXG4gIGlmIChvcGVuZXIgJiYgIW9wZW5lci5jbG9zZWQpXG4gIHtcbiAgICBwcmludGxuKFwiVXNpbmcgYm9va21hcmtsZXQgdmVyc2lvbiBvZiBzaGVsbDogY29tbWFuZHMgd2lsbCBydW4gaW4gb3BlbmVyJ3MgY29udGV4dC5cIiwgXCJtZXNzYWdlXCIpO1xuICAgIF93aW4gPSB3aW5kb3c7XG4gIH1cblxuICBpbml0VGFyZ2V0KCk7XG5cbiAgcmVjYWxjdWxhdGVJbnB1dEhlaWdodCgpO1xuICByZWZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGluaXRUYXJnZXQoKVxue1xuICBfd2luLlNoZWxsID0gd2luZG93O1xuICBfd2luLnByaW50ID0gc2hlbGxDb21tYW5kcy5wcmludDtcbn1cblxuXG4vLyBVbmxlc3MgdGhlIHVzZXIgaXMgc2VsZWN0ZWQgc29tZXRoaW5nLCByZWZvY3VzIHRoZSB0ZXh0Ym94LlxuLy8gKHJlcXVlc3RlZCBieSBjYWlsbG9uLCBicmVuZGFuLCBhc2EpXG5mdW5jdGlvbiBrZWVwRm9jdXNJblRleHRib3goZSlcbntcbiAgdmFyIGcgPSBlLnNyY0VsZW1lbnQgPyBlLnNyY0VsZW1lbnQgOiBlLnRhcmdldDsgLy8gSUUgdnMuIHN0YW5kYXJkXG5cbiAgd2hpbGUgKCFnLnRhZ05hbWUpXG4gICAgZyA9IGcucGFyZW50Tm9kZTtcbiAgdmFyIHQgPSBnLnRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgaWYgKHQ9PVwiQVwiIHx8IHQ9PVwiSU5QVVRcIilcbiAgICByZXR1cm47XG5cbiAgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcbiAgICAvLyBNb3ppbGxhXG4gICAgaWYgKFN0cmluZyh3aW5kb3cuZ2V0U2VsZWN0aW9uKCkpKVxuICAgICAgcmV0dXJuO1xuICB9XG4gIGVsc2UgaWYgKGRvY3VtZW50LmdldFNlbGVjdGlvbikge1xuICAgIC8vIE9wZXJhPyBOZXRzY2FwZSA0P1xuICAgIGlmIChkb2N1bWVudC5nZXRTZWxlY3Rpb24oKSlcbiAgICAgIHJldHVybjtcbiAgfVxuICBlbHNlIHtcbiAgICAvLyBJRVxuICAgIGlmICggZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dCApXG4gICAgICByZXR1cm47XG4gIH1cblxuICByZWZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGlucHV0S2V5ZG93bihlKSB7XG4gIC8vIFVzZSBvbmtleWRvd24gYmVjYXVzZSBJRSBkb2Vzbid0IHN1cHBvcnQgb25rZXlwcmVzcyBmb3IgYXJyb3cga2V5c1xuXG4gIC8vYWxlcnQoZS5rZXlDb2RlICsgXCIgXiBcIiArIGUua2V5Y29kZSk7XG5cbiAgaWYgKGUuc2hpZnRLZXkgJiYgZS5rZXlDb2RlID09IDEzKSB7IC8vIHNoaWZ0LWVudGVyXG4gICAgLy8gZG9uJ3QgZG8gYW55dGhpbmc7IGFsbG93IHRoZSBzaGlmdC1lbnRlciB0byBpbnNlcnQgYSBsaW5lIGJyZWFrIGFzIG5vcm1hbFxuICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAxMykgeyAvLyBlbnRlclxuICAgIC8vIGV4ZWN1dGUgdGhlIGlucHV0IG9uIGVudGVyXG4gICAgdHJ5IHsgZ28oKTsgfSBjYXRjaChlcikgeyBhbGVydChlcik7IH07XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgX2luLnZhbHVlID0gXCJcIjsgfSwgMCk7IC8vIGNhbid0IHByZXZlbnREZWZhdWx0IG9uIGlucHV0LCBzbyBjbGVhciBpdCBsYXRlclxuICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAzOCkgeyAvLyB1cFxuICAgIC8vIGdvIHVwIGluIGhpc3RvcnkgaWYgYXQgdG9wIG9yIGN0cmwtdXBcbiAgICBpZiAoZS5jdHJsS2V5IHx8IGNhcmV0SW5GaXJzdExpbmUoX2luKSlcbiAgICAgIGhpc3QodHJ1ZSk7XG4gIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDQwKSB7IC8vIGRvd25cbiAgICAvLyBnbyBkb3duIGluIGhpc3RvcnkgaWYgYXQgZW5kIG9yIGN0cmwtZG93blxuICAgIGlmIChlLmN0cmxLZXkgfHwgY2FyZXRJbkxhc3RMaW5lKF9pbikpXG4gICAgICBoaXN0KGZhbHNlKTtcbiAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT0gOSkgeyAvLyB0YWJcbiAgICB0YWJjb21wbGV0ZSgpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHJlZm9jdXMoKTsgfSwgMCk7IC8vIHJlZm9jdXMgYmVjYXVzZSB0YWIgd2FzIGhpdFxuICB9IGVsc2UgeyB9XG5cbiAgc2V0VGltZW91dChyZWNhbGN1bGF0ZUlucHV0SGVpZ2h0LCAwKTtcblxuICAvL3JldHVybiB0cnVlO1xufTtcblxuZnVuY3Rpb24gY2FyZXRJbkZpcnN0TGluZSh0ZXh0Ym94KVxue1xuICAvLyBJRSBkb2Vzbid0IHN1cHBvcnQgc2VsZWN0aW9uU3RhcnQvc2VsZWN0aW9uRW5kXG4gIGlmICh0ZXh0Ym94LnNlbGVjdGlvblN0YXJ0ID09IHVuZGVmaW5lZClcbiAgICByZXR1cm4gdHJ1ZTtcblxuICB2YXIgZmlyc3RMaW5lQnJlYWsgPSB0ZXh0Ym94LnZhbHVlLmluZGV4T2YoXCJcXG5cIik7XG5cbiAgcmV0dXJuICgoZmlyc3RMaW5lQnJlYWsgPT0gLTEpIHx8ICh0ZXh0Ym94LnNlbGVjdGlvblN0YXJ0IDw9IGZpcnN0TGluZUJyZWFrKSk7XG59XG5cbmZ1bmN0aW9uIGNhcmV0SW5MYXN0TGluZSh0ZXh0Ym94KVxue1xuICAvLyBJRSBkb2Vzbid0IHN1cHBvcnQgc2VsZWN0aW9uU3RhcnQvc2VsZWN0aW9uRW5kXG4gIGlmICh0ZXh0Ym94LnNlbGVjdGlvbkVuZCA9PSB1bmRlZmluZWQpXG4gICAgcmV0dXJuIHRydWU7XG5cbiAgdmFyIGxhc3RMaW5lQnJlYWsgPSB0ZXh0Ym94LnZhbHVlLmxhc3RJbmRleE9mKFwiXFxuXCIpO1xuXG4gIHJldHVybiAodGV4dGJveC5zZWxlY3Rpb25FbmQgPiBsYXN0TGluZUJyZWFrKTtcbn1cblxuZnVuY3Rpb24gcmVjYWxjdWxhdGVJbnB1dEhlaWdodCgpXG57XG4gIHZhciByb3dzID0gX2luLnZhbHVlLnNwbGl0KC9cXG4vKS5sZW5ndGhcbiAgICArIDEgLy8gcHJldmVudCBzY3JvbGxiYXIgZmxpY2tlcmluZyBpbiBNb3ppbGxhXG4gICAgKyAod2luZG93Lm9wZXJhID8gMSA6IDApOyAvLyBsZWF2ZSByb29tIGZvciBzY3JvbGxiYXIgaW4gT3BlcmFcblxuICBpZiAoX2luLnJvd3MgIT0gcm93cykgLy8gd2l0aG91dCB0aGlzIGNoZWNrLCBpdCBpcyBpbXBvc3NpYmxlIHRvIHNlbGVjdCB0ZXh0IGluIE9wZXJhIDcuNjAgb3IgT3BlcmEgOC4wLlxuICAgIF9pbi5yb3dzID0gcm93cztcbn1cblxuZnVuY3Rpb24gcHJpbnRsbihzLCB0eXBlKVxue1xuICBpZigocz1TdHJpbmcocykpKVxuICB7XG4gICAgdmFyIG5ld2RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgbmV3ZGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHMpKTtcbiAgICBuZXdkaXYuY2xhc3NOYW1lID0gdHlwZTtcbiAgICBfb3V0LmFwcGVuZENoaWxkKG5ld2Rpdik7XG4gICAgcmV0dXJuIG5ld2RpdjtcbiAgfVxufVxuXG5mdW5jdGlvbiBwcmludFdpdGhSdW5pbihoLCBzLCB0eXBlKVxue1xuICB2YXIgZGl2ID0gcHJpbnRsbihzLCB0eXBlKTtcbiAgdmFyIGhlYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3Ryb25nXCIpO1xuICBoZWFkLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGggKyBcIjogXCIpKTtcbiAgZGl2Lmluc2VydEJlZm9yZShoZWFkLCBkaXYuZmlyc3RDaGlsZCk7XG59XG5cblxudmFyIHNoZWxsQ29tbWFuZHMgPVxue1xubG9hZCA6IGZ1bmN0aW9uIGxvYWQodXJsKVxue1xuICB2YXIgcyA9IF93aW4uZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgcy50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcbiAgcy5zcmMgPSB1cmw7XG4gIF93aW4uZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKHMpO1xuICBwcmludGxuKFwiTG9hZGluZyBcIiArIHVybCArIFwiLi4uXCIsIFwibWVzc2FnZVwiKTtcbn0sXG5cbmNsZWFyIDogZnVuY3Rpb24gY2xlYXIoKVxue1xuICB2YXIgQ0hJTERSRU5fVE9fUFJFU0VSVkUgPSAzO1xuICB3aGlsZSAoX291dC5jaGlsZE5vZGVzW0NISUxEUkVOX1RPX1BSRVNFUlZFXSlcbiAgICBfb3V0LnJlbW92ZUNoaWxkKF9vdXQuY2hpbGROb2Rlc1tDSElMRFJFTl9UT19QUkVTRVJWRV0pO1xufSxcblxucHJpbnQgOiBmdW5jdGlvbiBwcmludChzKSB7IHByaW50bG4ocywgXCJwcmludFwiKTsgfSxcblxuLy8gdGhlIG5vcm1hbCBmdW5jdGlvbiwgXCJwcmludFwiLCBzaG91bGRuJ3QgcmV0dXJuIGEgdmFsdWVcbi8vIChzdWdnZXN0ZWQgYnkgYnJlbmRhbjsgbGF0ZXIgbm90aWNlZCBpdCB3YXMgYSBwcm9ibGVtIHdoZW4gc2hvd2luZyBvdGhlcnMpXG5wciA6IGZ1bmN0aW9uIHByKHMpXG57XG4gIHNoZWxsQ29tbWFuZHMucHJpbnQocyk7IC8vIG5lZWQgdG8gc3BlY2lmeSBzaGVsbENvbW1hbmRzIHNvIGl0IGRvZXNuJ3QgdHJ5IHdpbmRvdy5wcmludCgpIVxuICByZXR1cm4gcztcbn0sXG5cbnByb3BzIDogZnVuY3Rpb24gcHJvcHMoZSwgb25lUGVyTGluZSlcbntcbiAgaWYgKGUgPT09IG51bGwpIHtcbiAgICBwcmludGxuKFwicHJvcHMgY2FsbGVkIHdpdGggbnVsbCBhcmd1bWVudFwiLCBcImVycm9yXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChlID09PSB1bmRlZmluZWQpIHtcbiAgICBwcmludGxuKFwicHJvcHMgY2FsbGVkIHdpdGggdW5kZWZpbmVkIGFyZ3VtZW50XCIsIFwiZXJyb3JcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG5zID0gW1wiTWV0aG9kc1wiLCBcIkZpZWxkc1wiLCBcIlVucmVhY2hhYmxlc1wiXTtcbiAgdmFyIGFzID0gW1tdLCBbXSwgW11dOyAvLyBhcnJheSBvZiAoZW1wdHkpIGFycmF5cyBvZiBhcnJheXMhXG4gIHZhciBwLCBqLCBpOyAvLyBsb29wIHZhcmlhYmxlcywgc2V2ZXJhbCB1c2VkIG11bHRpcGxlIHRpbWVzXG5cbiAgdmFyIHByb3RvTGV2ZWxzID0gMDtcblxuICBmb3IgKHAgPSBlOyBwOyBwID0gcC5fX3Byb3RvX18pXG4gIHtcbiAgICBmb3IgKGk9MDsgaTxucy5sZW5ndGg7ICsraSlcbiAgICAgIGFzW2ldW3Byb3RvTGV2ZWxzXSA9IFtdO1xuICAgICsrcHJvdG9MZXZlbHM7XG4gIH1cblxuICBmb3IodmFyIGEgaW4gZSlcbiAge1xuICAgIC8vIFNob3J0Y29taW5nOiBkb2Vzbid0IGNoZWNrIHRoYXQgVkFMVUVTIGFyZSB0aGUgc2FtZSBpbiBvYmplY3QgYW5kIHByb3RvdHlwZS5cblxuICAgIHZhciBwcm90b0xldmVsID0gLTE7XG4gICAgdHJ5XG4gICAge1xuICAgICAgZm9yIChwID0gZTsgcCAmJiAoYSBpbiBwKTsgcCA9IHAuX19wcm90b19fKVxuICAgICAgICArK3Byb3RvTGV2ZWw7XG4gICAgfVxuICAgIGNhdGNoKGVyKSB7IHByb3RvTGV2ZWwgPSAwOyB9IC8vIFwiaW5cIiBvcGVyYXRvciB0aHJvd3Mgd2hlbiBwYXJhbSB0byBwcm9wcygpIGlzIGEgc3RyaW5nXG5cbiAgICB2YXIgdHlwZSA9IDE7XG4gICAgdHJ5XG4gICAge1xuICAgICAgaWYgKCh0eXBlb2YgZVthXSkgPT0gXCJmdW5jdGlvblwiKVxuICAgICAgICB0eXBlID0gMDtcbiAgICB9XG4gICAgY2F0Y2ggKGVyKSB7IHR5cGUgPSAyOyB9XG5cbiAgICBhc1t0eXBlXVtwcm90b0xldmVsXS5wdXNoKGEpO1xuICB9XG5cbiAgZnVuY3Rpb24gdGltZXMocywgbikgeyByZXR1cm4gbiA/IHMgKyB0aW1lcyhzLCBuLTEpIDogXCJcIjsgfVxuXG4gIGZvciAoaj0wOyBqPHByb3RvTGV2ZWxzOyArK2opXG4gICAgZm9yIChpPTA7aTxucy5sZW5ndGg7KytpKVxuICAgICAgaWYgKGFzW2ldW2pdLmxlbmd0aClcbiAgICAgICAgcHJpbnRXaXRoUnVuaW4oXG4gICAgICAgICAgbnNbaV0gKyB0aW1lcyhcIiBvZiBwcm90b3R5cGVcIiwgaiksXG4gICAgICAgICAgKG9uZVBlckxpbmUgPyBcIlxcblxcblwiIDogXCJcIikgKyBhc1tpXVtqXS5zb3J0KCkuam9pbihvbmVQZXJMaW5lID8gXCJcXG5cIiA6IFwiLCBcIikgKyAob25lUGVyTGluZSA/IFwiXFxuXFxuXCIgOiBcIlwiKSxcbiAgICAgICAgICBcInByb3BMaXN0XCJcbiAgICAgICAgKTtcbn0sXG5cbmJsaW5rIDogZnVuY3Rpb24gYmxpbmsobm9kZSlcbntcbiAgaWYgKCFub2RlKSAgICAgICAgICAgICAgICAgICAgIHRocm93KFwiYmxpbms6IGFyZ3VtZW50IGlzIG51bGwgb3IgdW5kZWZpbmVkLlwiKTtcbiAgaWYgKG5vZGUubm9kZVR5cGUgPT0gbnVsbCkgICAgIHRocm93KFwiYmxpbms6IGFyZ3VtZW50IG11c3QgYmUgYSBub2RlLlwiKTtcbiAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMykgICAgICAgIHRocm93KFwiYmxpbms6IGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgdGV4dCBub2RlXCIpO1xuICBpZiAobm9kZS5kb2N1bWVudEVsZW1lbnQpICAgICAgdGhyb3coXCJibGluazogYXJndW1lbnQgbXVzdCBub3QgYmUgdGhlIGRvY3VtZW50IG9iamVjdFwiKTtcblxuICBmdW5jdGlvbiBzZXRPdXRsaW5lKG8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAobm9kZS5zdHlsZS5vdXRsaW5lICE9IG5vZGUuc3R5bGUuYm9ndXNQcm9wZXJ0eSkge1xuICAgICAgICAvLyBicm93c2VyIHN1cHBvcnRzIG91dGxpbmUgKEZpcmVmb3ggMS4xIGFuZCBuZXdlciwgQ1NTMywgT3BlcmEgOCkuXG4gICAgICAgIG5vZGUuc3R5bGUub3V0bGluZSA9IG87XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChub2RlLnN0eWxlLk1vek91dGxpbmUgIT0gbm9kZS5zdHlsZS5ib2d1c1Byb3BlcnR5KSB7XG4gICAgICAgIC8vIGJyb3dzZXIgc3VwcG9ydHMgTW96T3V0bGluZSAoRmlyZWZveCAxLjAueCBhbmQgb2xkZXIpXG4gICAgICAgIG5vZGUuc3R5bGUuTW96T3V0bGluZSA9IG87XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gYnJvd3NlciBvbmx5IHN1cHBvcnRzIGJvcmRlciAoSUUpLiBib3JkZXIgaXMgYSBmYWxsYmFjayBiZWNhdXNlIGl0IG1vdmVzIHRoaW5ncyBhcm91bmQuXG4gICAgICAgIG5vZGUuc3R5bGUuYm9yZGVyID0gbztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBmb2N1c0l0KGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBhLmZvY3VzKCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG5vZGUub3duZXJEb2N1bWVudCkge1xuICAgIHZhciB3aW5kb3dUb0ZvY3VzTm93ID0gKG5vZGUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyB8fCBub2RlLm93bmVyRG9jdW1lbnQucGFyZW50V2luZG93KTsgLy8gTW96IHZzLiBJRVxuICAgIGlmICh3aW5kb3dUb0ZvY3VzTm93KVxuICAgICAgc2V0VGltZW91dChmb2N1c0l0KHdpbmRvd1RvRm9jdXNOb3cudG9wKSwgMCk7XG4gIH1cblxuICBmb3IodmFyIGk9MTtpPDc7KytpKVxuICAgIHNldFRpbWVvdXQoc2V0T3V0bGluZSgoaSUyKT8nM3B4IHNvbGlkIHJlZCc6J25vbmUnKSwgaSoxMDApO1xuXG4gIHNldFRpbWVvdXQoZm9jdXNJdCh3aW5kb3cpLCA4MDApO1xuICBzZXRUaW1lb3V0KGZvY3VzSXQoX2luKSwgODEwKTtcbn0sXG5cbnNjb3BlIDogZnVuY3Rpb24gc2NvcGUoc2MpXG57XG4gIGlmICghc2MpIHNjID0ge307XG4gIF9zY29wZSA9IHNjO1xuICBwcmludGxuKFwiU2NvcGUgaXMgbm93IFwiICsgc2MgKyBcIi4gIElmIGEgdmFyaWFibGUgaXMgbm90IGZvdW5kIGluIHRoaXMgc2NvcGUsIHdpbmRvdyB3aWxsIGFsc28gYmUgc2VhcmNoZWQuICBOZXcgdmFyaWFibGVzIHdpbGwgc3RpbGwgZ28gb24gd2luZG93LlwiLCBcIm1lc3NhZ2VcIik7XG59LFxuXG5tYXRoSGVscCA6IGZ1bmN0aW9uIG1hdGhIZWxwKClcbntcbiAgcHJpbnRXaXRoUnVuaW4oXCJNYXRoIGNvbnN0YW50c1wiLCBcIkUsIExOMiwgTE4xMCwgTE9HMkUsIExPRzEwRSwgUEksIFNRUlQxXzIsIFNRUlQyXCIsIFwicHJvcExpc3RcIik7XG4gIHByaW50V2l0aFJ1bmluKFwiTWF0aCBtZXRob2RzXCIsIFwiYWJzLCBhY29zLCBhc2luLCBhdGFuLCBhdGFuMiwgY2VpbCwgY29zLCBleHAsIGZsb29yLCBsb2csIG1heCwgbWluLCBwb3csIHJhbmRvbSwgcm91bmQsIHNpbiwgc3FydCwgdGFuXCIsIFwicHJvcExpc3RcIik7XG59LFxuXG5hbnMgOiB1bmRlZmluZWRcbn07XG5cblxuZnVuY3Rpb24gaGlzdCh1cClcbntcbiAgLy8gaGlzdExpc3RbMF0gPSBmaXJzdCBjb21tYW5kIGVudGVyZWQsIFsxXSA9IHNlY29uZCwgZXRjLlxuICAvLyB0eXBlIHNvbWV0aGluZywgcHJlc3MgdXAgLS0+IHRoaW5nIHR5cGVkIGlzIG5vdyBpbiBcImxpbWJvXCJcbiAgLy8gKGxhc3QgaXRlbSBpbiBoaXN0TGlzdCkgYW5kIHNob3VsZCBiZSByZWFjaGFibGUgYnkgcHJlc3NpbmdcbiAgLy8gZG93biBhZ2Fpbi5cblxuICB2YXIgTCA9IGhpc3RMaXN0Lmxlbmd0aDtcblxuICBpZiAoTCA9PSAxKVxuICAgIHJldHVybjtcblxuICBpZiAodXApXG4gIHtcbiAgICBpZiAoaGlzdFBvcyA9PSBMLTEpXG4gICAge1xuICAgICAgLy8gU2F2ZSB0aGlzIGVudHJ5IGluIGNhc2UgdGhlIHVzZXIgaGl0cyB0aGUgZG93biBrZXkuXG4gICAgICBoaXN0TGlzdFtoaXN0UG9zXSA9IF9pbi52YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAoaGlzdFBvcyA+IDApXG4gICAge1xuICAgICAgaGlzdFBvcy0tO1xuICAgICAgLy8gVXNlIGEgdGltZW91dCB0byBwcmV2ZW50IHVwIGZyb20gbW92aW5nIGN1cnNvciB3aXRoaW4gbmV3IHRleHRcbiAgICAgIC8vIFNldCB0byBub3RoaW5nIGZpcnN0IGZvciB0aGUgc2FtZSByZWFzb25cbiAgICAgIHNldFRpbWVvdXQoXG4gICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIF9pbi52YWx1ZSA9ICcnO1xuICAgICAgICAgIF9pbi52YWx1ZSA9IGhpc3RMaXN0W2hpc3RQb3NdO1xuICAgICAgICAgIHZhciBjYXJldFBvcyA9IF9pbi52YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgaWYgKF9pbi5zZXRTZWxlY3Rpb25SYW5nZSlcbiAgICAgICAgICAgIF9pbi5zZXRTZWxlY3Rpb25SYW5nZShjYXJldFBvcywgY2FyZXRQb3MpO1xuICAgICAgICB9LFxuICAgICAgICAwXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBlbHNlIC8vIGRvd25cbiAge1xuICAgIGlmIChoaXN0UG9zIDwgTC0xKVxuICAgIHtcbiAgICAgIGhpc3RQb3MrKztcbiAgICAgIF9pbi52YWx1ZSA9IGhpc3RMaXN0W2hpc3RQb3NdO1xuICAgIH1cbiAgICBlbHNlIGlmIChoaXN0UG9zID09IEwtMSlcbiAgICB7XG4gICAgICAvLyBBbHJlYWR5IG9uIHRoZSBjdXJyZW50IGVudHJ5OiBjbGVhciBidXQgc2F2ZVxuICAgICAgaWYgKF9pbi52YWx1ZSlcbiAgICAgIHtcbiAgICAgICAgaGlzdExpc3RbaGlzdFBvc10gPSBfaW4udmFsdWU7XG4gICAgICAgICsraGlzdFBvcztcbiAgICAgICAgX2luLnZhbHVlID0gXCJcIjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gdGFiY29tcGxldGUoKVxue1xuICAvKlxuICAgKiBXb3JraW5nIGJhY2t3YXJkcyBmcm9tIHNbZnJvbV0sIGZpbmQgdGhlIHNwb3RcbiAgICogd2hlcmUgdGhpcyBleHByZXNzaW9uIHN0YXJ0cy4gIEl0IHdpbGwgc2NhblxuICAgKiB1bnRpbCBpdCBoaXRzIGEgbWlzbWF0Y2hlZCAoIG9yIGEgc3BhY2UsXG4gICAqIGJ1dCBpdCBza2lwcyBvdmVyIHF1b3RlZCBzdHJpbmdzLlxuICAgKiBJZiBzdG9wQXREb3QgaXMgdHJ1ZSwgc3RvcCBhdCBhICcuJ1xuICAgKi9cbiAgZnVuY3Rpb24gZmluZGJlZ2lubmluZyhzLCBmcm9tLCBzdG9wQXREb3QpXG4gIHtcbiAgICAvKlxuICAgICAqICBDb21wbGljYXRlZCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqICBSZXR1cm4gdHJ1ZSBpZiBzW2ldID09IHEgQlVUIE9OTFkgSUZcbiAgICAgKiAgc1tpLTFdIGlzIG5vdCBhIGJhY2tzbGFzaC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBlcXVhbEJ1dE5vdEVzY2FwZWQocyxpLHEpXG4gICAge1xuICAgICAgaWYocy5jaGFyQXQoaSkgIT0gcSkgLy8gbm90IGVxdWFsIGdvIG5vIGZ1cnRoZXJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICBpZihpPT0wKSAvLyBiZWdpbm5pbmcgb2Ygc3RyaW5nXG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICBpZihzLmNoYXJBdChpLTEpID09ICdcXFxcJykgLy8gZXNjYXBlZD9cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgbnBhcmVucyA9IDA7XG4gICAgdmFyIGk7XG4gICAgZm9yKGk9ZnJvbTsgaT49MDsgaS0tKVxuICAgIHtcbiAgICAgIGlmKHMuY2hhckF0KGkpID09ICcgJylcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGlmKHN0b3BBdERvdCAmJiBzLmNoYXJBdChpKSA9PSAnLicpXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBpZihzLmNoYXJBdChpKSA9PSAnKScpXG4gICAgICAgIG5wYXJlbnMrKztcbiAgICAgIGVsc2UgaWYocy5jaGFyQXQoaSkgPT0gJygnKVxuICAgICAgICBucGFyZW5zLS07XG5cbiAgICAgIGlmKG5wYXJlbnMgPCAwKVxuICAgICAgICBicmVhaztcblxuICAgICAgLy8gc2tpcCBxdW90ZWQgc3RyaW5nc1xuICAgICAgaWYocy5jaGFyQXQoaSkgPT0gJ1xcJycgfHwgcy5jaGFyQXQoaSkgPT0gJ1xcXCInKVxuICAgICAge1xuICAgICAgICAvL2R1bXAoXCJza2lwcGluZyBxdW90ZWQgY2hhcnM6IFwiKTtcbiAgICAgICAgdmFyIHF1b3QgPSBzLmNoYXJBdChpKTtcbiAgICAgICAgaS0tO1xuICAgICAgICB3aGlsZShpID49IDAgJiYgIWVxdWFsQnV0Tm90RXNjYXBlZChzLGkscXVvdCkpIHtcbiAgICAgICAgICAvL2R1bXAocy5jaGFyQXQoaSkpO1xuICAgICAgICAgIGktLTtcbiAgICAgICAgfVxuICAgICAgICAvL2R1bXAoXCJcXG5cIik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xuICB9XG5cbiAgLy8gWFhYIHNob3VsZCBiZSB1c2VkIG1vcmUgY29uc2lzdGVudGx5IChpbnN0ZWFkIG9mIHVzaW5nIHNlbGVjdGlvblN0YXJ0L3NlbGVjdGlvbkVuZCB0aHJvdWdob3V0IGNvZGUpXG4gIC8vIFhYWCBkb2Vzbid0IHdvcmsgaW4gSUUsIGV2ZW4gdGhvdWdoIGl0IGNvbnRhaW5zIElFLXNwZWNpZmljIGNvZGVcbiAgZnVuY3Rpb24gZ2V0Y2FyZXRwb3MoaW5wKVxuICB7XG4gICAgaWYoaW5wLnNlbGVjdGlvbkVuZCAhPSBudWxsKVxuICAgICAgcmV0dXJuIGlucC5zZWxlY3Rpb25FbmQ7XG5cbiAgICBpZihpbnAuY3JlYXRlVGV4dFJhbmdlKVxuICAgIHtcbiAgICAgIHZhciBkb2NyYW5nZSA9IF93aW4uU2hlbGwuZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICB2YXIgaW5wcmFuZ2UgPSBpbnAuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICBpZiAoaW5wcmFuZ2Uuc2V0RW5kUG9pbnQpXG4gICAgICB7XG4gICAgICAgIGlucHJhbmdlLnNldEVuZFBvaW50KCdFbmRUb1N0YXJ0JywgZG9jcmFuZ2UpO1xuICAgICAgICByZXR1cm4gaW5wcmFuZ2UudGV4dC5sZW5ndGg7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGlucC52YWx1ZS5sZW5ndGg7IC8vIHN1Y2tzLCBwdW50XG4gIH1cblxuICBmdW5jdGlvbiBzZXRzZWxlY3Rpb250byhpbnAscG9zKVxuICB7XG4gICAgaWYoaW5wLnNlbGVjdGlvblN0YXJ0KSB7XG4gICAgICBpbnAuc2VsZWN0aW9uU3RhcnQgPSBpbnAuc2VsZWN0aW9uRW5kID0gcG9zO1xuICAgIH1cbiAgICBlbHNlIGlmKGlucC5jcmVhdGVUZXh0UmFuZ2UpIHtcbiAgICAgIHZhciBkb2NyYW5nZSA9IF93aW4uU2hlbGwuZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICB2YXIgaW5wcmFuZ2UgPSBpbnAuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICBpbnByYW5nZS5tb3ZlKCdjaGFyYWN0ZXInLHBvcyk7XG4gICAgICBpbnByYW5nZS5zZWxlY3QoKTtcbiAgICB9XG4gICAgZWxzZSB7IC8vIGVyci4uLlxuICAgIC8qXG4gICAgICBpbnAuc2VsZWN0KCk7XG4gICAgICBpZihfd2luLlNoZWxsLmRvY3VtZW50LmdldFNlbGVjdGlvbigpKVxuICAgICAgICBfd2luLlNoZWxsLmRvY3VtZW50LmdldFNlbGVjdGlvbigpID0gXCJcIjtcbiAgICAgICAgKi9cbiAgICB9XG4gIH1cbiAgICAvLyBnZXQgcG9zaXRpb24gb2YgY3Vyc29yIHdpdGhpbiB0aGUgaW5wdXQgYm94XG4gICAgdmFyIGNhcmV0ID0gZ2V0Y2FyZXRwb3MoX2luKTtcblxuICAgIGlmKGNhcmV0KSB7XG4gICAgICAvL2R1bXAoXCItLS0tXFxuXCIpO1xuICAgICAgdmFyIGRvdHBvcywgc3BhY2Vwb3MsIGNvbXBsZXRlLCBvYmo7XG4gICAgICAvL2R1bXAoXCJjYXJldCBwb3M6IFwiICsgY2FyZXQgKyBcIlxcblwiKTtcbiAgICAgIC8vIHNlZSBpZiB0aGVyZSdzIGEgZG90IGJlZm9yZSBoZXJlXG4gICAgICBkb3Rwb3MgPSBmaW5kYmVnaW5uaW5nKF9pbi52YWx1ZSwgY2FyZXQtMSwgdHJ1ZSk7XG4gICAgICAvL2R1bXAoXCJkb3QgcG9zOiBcIiArIGRvdHBvcyArIFwiXFxuXCIpO1xuICAgICAgaWYoZG90cG9zID09IC0xIHx8IF9pbi52YWx1ZS5jaGFyQXQoZG90cG9zKSAhPSAnLicpIHtcbiAgICAgICAgZG90cG9zID0gY2FyZXQ7XG4vL2R1bXAoXCJjaGFuZ2VkIGRvdCBwb3M6IFwiICsgZG90cG9zICsgXCJcXG5cIik7XG4gICAgICB9XG5cbiAgICAgIC8vIGxvb2sgYmFja3dhcmRzIGZvciBhIG5vbi12YXJpYWJsZS1uYW1lIGNoYXJhY3RlclxuICAgICAgc3BhY2Vwb3MgPSBmaW5kYmVnaW5uaW5nKF9pbi52YWx1ZSwgZG90cG9zLTEsIGZhbHNlKTtcbiAgICAgIC8vZHVtcChcInNwYWNlIHBvczogXCIgKyBzcGFjZXBvcyArIFwiXFxuXCIpO1xuICAgICAgLy8gZ2V0IHRoZSBvYmplY3Qgd2UncmUgdHJ5aW5nIHRvIGNvbXBsZXRlIG9uXG4gICAgICBpZihzcGFjZXBvcyA9PSBkb3Rwb3MgfHwgc3BhY2Vwb3MrMSA9PSBkb3Rwb3MgfHwgZG90cG9zID09IGNhcmV0KVxuICAgICAge1xuICAgICAgICAvLyB0cnkgY29tcGxldGluZyBmdW5jdGlvbiBhcmdzXG4gICAgICAgIGlmKF9pbi52YWx1ZS5jaGFyQXQoZG90cG9zKSA9PSAnKCcgfHxcbiAoX2luLnZhbHVlLmNoYXJBdChzcGFjZXBvcykgPT0gJygnICYmIChzcGFjZXBvcysxKSA9PSBkb3Rwb3MpKVxuICAgICAgICB7XG4gICAgICAgICAgdmFyIGZuLGZuYW1lO1xuICB2YXIgZnJvbSA9IChfaW4udmFsdWUuY2hhckF0KGRvdHBvcykgPT0gJygnKSA/IGRvdHBvcyA6IHNwYWNlcG9zO1xuICAgICAgICAgIHNwYWNlcG9zID0gZmluZGJlZ2lubmluZyhfaW4udmFsdWUsIGZyb20tMSwgZmFsc2UpO1xuXG4gICAgICAgICAgZm5hbWUgPSBfaW4udmFsdWUuc3Vic3RyKHNwYWNlcG9zKzEsZnJvbS0oc3BhY2Vwb3MrMSkpO1xuICAvL2R1bXAoXCJmbmFtZTogXCIgKyBmbmFtZSArIFwiXFxuXCIpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB3aXRoKF93aW4uU2hlbGwuX3Njb3BlKVxuICAgICAgICAgICAgICB3aXRoKF93aW4pXG4gICAgICAgICAgICAgICAgd2l0aChTaGVsbC5zaGVsbENvbW1hbmRzKVxuICAgICAgICAgICAgICAgICAgZm4gPSBldmFsKGZuYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2F0Y2goZXIpIHtcbiAgICAgICAgICAgIC8vZHVtcCgnZm4gaXMgbm90IGEgdmFsaWQgb2JqZWN0XFxuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKGZuID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgIC8vZHVtcCgnZm4gaXMgdW5kZWZpbmVkJyk7XG4gICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihmbiBpbnN0YW5jZW9mIEZ1bmN0aW9uKVxuICAgICAgICAgIHtcbiAgICAgICAgICAgIC8vIFByaW50IGZ1bmN0aW9uIGRlZmluaXRpb24sIGluY2x1ZGluZyBhcmd1bWVudCBuYW1lcywgYnV0IG5vdCBmdW5jdGlvbiBib2R5XG4gICAgICAgICAgICBpZighZm4udG9TdHJpbmcoKS5tYXRjaCgvZnVuY3Rpb24gLis/XFwoXFwpICtcXHtcXG4gK1xcW25hdGl2ZSBjb2RlXFxdXFxuXFx9LykpXG4gICAgICAgICAgICAgIHByaW50bG4oZm4udG9TdHJpbmcoKS5tYXRjaCgvZnVuY3Rpb24gLis/XFwoLio/XFwpLyksIFwidGFiY29tcGxldGVcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICBvYmogPSBfd2luO1xuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuICAgICAgICB2YXIgb2JqbmFtZSA9IF9pbi52YWx1ZS5zdWJzdHIoc3BhY2Vwb3MrMSxkb3Rwb3MtKHNwYWNlcG9zKzEpKTtcbiAgICAgICAgLy9kdW1wKFwib2JqbmFtZTogfFwiICsgb2JqbmFtZSArIFwifFxcblwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB3aXRoKF93aW4uU2hlbGwuX3Njb3BlKVxuICAgICAgICAgICAgd2l0aChfd2luKVxuICAgICAgICAgICAgICAgIG9iaiA9IGV2YWwob2JqbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZXIpIHtcbiAgICAgICAgICBwcmludEVycm9yKGVyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYob2JqID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIC8vIHNvbWV0aW1lcyB0aGlzIGlzIHRhYmNvbXBsZXRlJ3MgZmF1bHQsIHNvIGRvbid0IHByaW50IGl0IDooXG4gICAgICAgICAgLy8gZS5nLiBjb21wbGV0aW5nIGZyb20gXCJwcmludChkb2N1bWVudC5nZXRFbGVtZW50c1wiXG4gICAgICAgICAgLy8gcHJpbnRsbihcIkNhbid0IGNvbXBsZXRlIGZyb20gbnVsbCBvciB1bmRlZmluZWQgZXhwcmVzc2lvbiBcIiArIG9iam5hbWUsIFwiZXJyb3JcIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvL2R1bXAoXCJvYmo6IFwiICsgb2JqICsgXCJcXG5cIik7XG4gICAgICAvLyBnZXQgdGhlIHRoaW5nIHdlJ3JlIHRyeWluZyB0byBjb21wbGV0ZVxuICAgICAgaWYoZG90cG9zID09IGNhcmV0KVxuICAgICAge1xuICAgICAgICBpZihzcGFjZXBvcysxID09IGRvdHBvcyB8fCBzcGFjZXBvcyA9PSBkb3Rwb3MpXG4gICAgICAgIHtcbiAgICAgICAgICAvLyBub3RoaW5nIHRvIGNvbXBsZXRlXG4gICAgICAgICAgLy9kdW1wKFwibm90aGluZyB0byBjb21wbGV0ZVxcblwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb21wbGV0ZSA9IF9pbi52YWx1ZS5zdWJzdHIoc3BhY2Vwb3MrMSxkb3Rwb3MtKHNwYWNlcG9zKzEpKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBjb21wbGV0ZSA9IF9pbi52YWx1ZS5zdWJzdHIoZG90cG9zKzEsY2FyZXQtKGRvdHBvcysxKSk7XG4gICAgICB9XG4gICAgICAvL2R1bXAoXCJjb21wbGV0ZTogXCIgKyBjb21wbGV0ZSArIFwiXFxuXCIpO1xuICAgICAgLy8gb2ssIG5vdyBsb29rIGF0IGFsbCB0aGUgcHJvcHMvbWV0aG9kcyBvZiB0aGlzIG9ialxuICAgICAgLy8gYW5kIGZpbmQgb25lcyBzdGFydGluZyB3aXRoICdjb21wbGV0ZSdcbiAgICAgIHZhciBtYXRjaGVzID0gW107XG4gICAgICB2YXIgYmVzdG1hdGNoID0gbnVsbDtcbiAgICAgIGZvcih2YXIgYSBpbiBvYmopXG4gICAgICB7XG4gICAgICAgIC8vYSA9IGEudG9TdHJpbmcoKTtcbiAgICAgICAgLy9YWFg6IG1ha2luZyBpdCBsb3dlcmNhc2UgY291bGQgaGVscCBzb21lIGNhc2VzLFxuICAgICAgICAvLyBidXQgc2NyZXdzIHVwIG15IGdlbmVyYWwgbG9naWMuXG4gICAgICAgIGlmKGEuc3Vic3RyKDAsY29tcGxldGUubGVuZ3RoKSA9PSBjb21wbGV0ZSkge1xuICAgICAgICAgIG1hdGNoZXMucHVzaChhKTtcbiAgICAgICAgICAvLy8vZHVtcChcIm1hdGNoOiBcIiArIGEgKyBcIlxcblwiKTtcbiAgICAgICAgICAvLyBpZiBubyBiZXN0IG1hdGNoLCB0aGlzIGlzIHRoZSBiZXN0IG1hdGNoXG4gICAgICAgICAgaWYoYmVzdG1hdGNoID09IG51bGwpXG4gICAgICAgICAge1xuICAgICAgICAgICAgYmVzdG1hdGNoID0gYTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0aGUgYmVzdCBtYXRjaCBpcyB0aGUgbG9uZ2VzdCBjb21tb24gc3RyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBtaW4oYSxiKXsgcmV0dXJuICgoYTxiKT9hOmIpOyB9XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvcihpPTA7IGk8IG1pbihiZXN0bWF0Y2gubGVuZ3RoLCBhLmxlbmd0aCk7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWYoYmVzdG1hdGNoLmNoYXJBdChpKSAhPSBhLmNoYXJBdChpKSlcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJlc3RtYXRjaCA9IGJlc3RtYXRjaC5zdWJzdHIoMCxpKTtcbiAgICAgICAgICAgIC8vLy9kdW1wKFwiYmVzdG1hdGNoIGxlbjogXCIgKyBpICsgXCJcXG5cIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vLy9kdW1wKFwiYmVzdG1hdGNoOiBcIiArIGJlc3RtYXRjaCArIFwiXFxuXCIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBiZXN0bWF0Y2ggPSAoYmVzdG1hdGNoIHx8IFwiXCIpO1xuICAgICAgLy8vL2R1bXAoXCJtYXRjaGVzOiBcIiArIG1hdGNoZXMgKyBcIlxcblwiKTtcbiAgICAgIHZhciBvYmpBbmRDb21wbGV0ZSA9IChvYmpuYW1lIHx8IG9iaikgKyBcIi5cIiArIGJlc3RtYXRjaDtcbiAgICAgIC8vZHVtcChcIm1hdGNoZXMubGVuZ3RoOiBcIiArIG1hdGNoZXMubGVuZ3RoICsgXCIsIHRvb01hbnlNYXRjaGVzOiBcIiArIHRvb01hbnlNYXRjaGVzICsgXCIsIG9iakFuZENvbXBsZXRlOiBcIiArIG9iakFuZENvbXBsZXRlICsgXCJcXG5cIik7XG4gICAgICBpZihtYXRjaGVzLmxlbmd0aCA+IDEgJiYgKHRvb01hbnlNYXRjaGVzID09IG9iakFuZENvbXBsZXRlIHx8IG1hdGNoZXMubGVuZ3RoIDw9IDEwKSkge1xuXG4gICAgICAgIHByaW50V2l0aFJ1bmluKFwiTWF0Y2hlczogXCIsIG1hdGNoZXMuam9pbignLCAnKSwgXCJ0YWJjb21wbGV0ZVwiKTtcbiAgICAgICAgdG9vTWFueU1hdGNoZXMgPSBudWxsO1xuICAgICAgfVxuICAgICAgZWxzZSBpZihtYXRjaGVzLmxlbmd0aCA+IDEwKVxuICAgICAge1xuICAgICAgICBwcmludGxuKG1hdGNoZXMubGVuZ3RoICsgXCIgbWF0Y2hlcy4gIFByZXNzIHRhYiBhZ2FpbiB0byBzZWUgdGhlbSBhbGxcIiwgXCJ0YWJjb21wbGV0ZVwiKTtcbiAgICAgICAgdG9vTWFueU1hdGNoZXMgPSBvYmpBbmRDb21wbGV0ZTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB0b29NYW55TWF0Y2hlcyA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZihiZXN0bWF0Y2ggIT0gXCJcIilcbiAgICAgIHtcbiAgICAgICAgdmFyIHNzdGFydDtcbiAgICAgICAgaWYoZG90cG9zID09IGNhcmV0KSB7XG4gICAgICAgICAgc3N0YXJ0ID0gc3BhY2Vwb3MrMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBzc3RhcnQgPSBkb3Rwb3MrMTtcbiAgICAgICAgfVxuICAgICAgICBfaW4udmFsdWUgPSBfaW4udmFsdWUuc3Vic3RyKDAsIHNzdGFydClcbiAgICAgICAgICAgICAgICAgICsgYmVzdG1hdGNoXG4gICAgICAgICAgICAgICAgICArIF9pbi52YWx1ZS5zdWJzdHIoY2FyZXQpO1xuICAgICAgICBzZXRzZWxlY3Rpb250byhfaW4sY2FyZXQgKyAoYmVzdG1hdGNoLmxlbmd0aCAtIGNvbXBsZXRlLmxlbmd0aCkpO1xuICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcHJpbnRRdWVzdGlvbihxKVxue1xuICBwcmludGxuKHEsIFwiaW5wdXRcIik7XG59XG5cbmZ1bmN0aW9uIHByaW50QW5zd2VyKGEpXG57XG4gIGlmIChhICE9PSB1bmRlZmluZWQpIHtcbiAgICBwcmludGxuKGEsIFwibm9ybWFsT3V0cHV0XCIpO1xuICAgIHNoZWxsQ29tbWFuZHMuYW5zID0gYTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwcmludEVycm9yKGVyKVxue1xuICB2YXIgbGluZU51bWJlclN0cmluZztcblxuICBsYXN0RXJyb3IgPSBlcjsgLy8gZm9yIGRlYnVnZ2luZyB0aGUgc2hlbGxcbiAgaWYgKGVyLm5hbWUpXG4gIHtcbiAgICAvLyBsaW5lTnVtYmVyU3RyaW5nIHNob3VsZCBub3QgYmUgXCJcIiwgdG8gYXZvaWQgYSB2ZXJ5IHdhY2t5IGJ1ZyBpbiBJRSA2LlxuICAgIGxpbmVOdW1iZXJTdHJpbmcgPSAoZXIubGluZU51bWJlciAhPSB1bmRlZmluZWQpID8gKFwiIG9uIGxpbmUgXCIgKyBlci5saW5lTnVtYmVyICsgXCI6IFwiKSA6IFwiOiBcIjtcbiAgICBwcmludGxuKGVyLm5hbWUgKyBsaW5lTnVtYmVyU3RyaW5nICsgZXIubWVzc2FnZSwgXCJlcnJvclwiKTsgLy8gQmVjYXVzZSBJRSBkb2Vzbid0IGhhdmUgZXJyb3IudG9TdHJpbmcuXG4gIH1cbiAgZWxzZVxuICAgIHByaW50bG4oZXIsIFwiZXJyb3JcIik7IC8vIEJlY2F1c2Ugc2VjdXJpdHkgZXJyb3JzIGluIE1veiAvb25seS8gaGF2ZSB0b1N0cmluZy5cbn1cblxuZnVuY3Rpb24gZ28ocylcbntcbiAgX2luLnZhbHVlID0gcXVlc3Rpb24gPSBzID8gcyA6IF9pbi52YWx1ZTtcblxuICBpZiAocXVlc3Rpb24gPT0gXCJcIilcbiAgICByZXR1cm47XG5cbiAgaGlzdExpc3RbaGlzdExpc3QubGVuZ3RoLTFdID0gcXVlc3Rpb247XG4gIGhpc3RMaXN0W2hpc3RMaXN0Lmxlbmd0aF0gPSBcIlwiO1xuICBoaXN0UG9zID0gaGlzdExpc3QubGVuZ3RoIC0gMTtcblxuICAvLyBVbmZvcnR1bmF0ZWx5LCB0aGlzIGhhcyB0byBoYXBwZW4gKmJlZm9yZSogdGhlIEphdmFTY3JpcHQgaXMgcnVuLCBzbyB0aGF0XG4gIC8vIHByaW50KCkgb3V0cHV0IHdpbGwgZ28gaW4gdGhlIHJpZ2h0IHBsYWNlLlxuICBfaW4udmFsdWU9Jyc7XG4gIHJlY2FsY3VsYXRlSW5wdXRIZWlnaHQoKTtcbiAgcHJpbnRRdWVzdGlvbihxdWVzdGlvbik7XG5cbiAgaWYgKF93aW4uY2xvc2VkKSB7XG4gICAgcHJpbnRFcnJvcihcIlRhcmdldCB3aW5kb3cgaGFzIGJlZW4gY2xvc2VkLlwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB0cnkgeyAoXCJTaGVsbFwiIGluIF93aW4pIH1cbiAgY2F0Y2goZXIpIHtcbiAgICBwcmludEVycm9yKFwiVGhlIEphdmFTY3JpcHQgU2hlbGwgY2Fubm90IGFjY2VzcyB2YXJpYWJsZXMgaW4gdGhlIHRhcmdldCB3aW5kb3cuICBUaGUgbW9zdCBsaWtlbHkgcmVhc29uIGlzIHRoYXQgdGhlIHRhcmdldCB3aW5kb3cgbm93IGhhcyBhIGRpZmZlcmVudCBwYWdlIGxvYWRlZCBhbmQgdGhhdCBwYWdlIGhhcyBhIGRpZmZlcmVudCBob3N0bmFtZSB0aGFuIHRoZSBvcmlnaW5hbCBwYWdlLlwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIShcIlNoZWxsXCIgaW4gX3dpbikpXG4gICAgaW5pdFRhcmdldCgpOyAvLyBzaWxlbnRcblxuICAvLyBFdmFsdWF0ZSBTaGVsbC5xdWVzdGlvbiB1c2luZyBfd2luJ3MgZXZhbCAodGhpcyBpcyB3aHkgZXZhbCBpc24ndCBpbiB0aGUgfHdpdGh8LCBJSVJDKS5cbiAgX3dpbi5sb2NhdGlvbi5ocmVmID0gXCJqYXZhc2NyaXB0OnRyeXsgU2hlbGwucHJpbnRBbnN3ZXIoZXZhbCgnd2l0aChTaGVsbC5fc2NvcGUpIHdpdGgoU2hlbGwuc2hlbGxDb21tYW5kcykgeycgKyBTaGVsbC5xdWVzdGlvbiArIFN0cmluZy5mcm9tQ2hhckNvZGUoMTApICsgJ30nKSk7IH0gY2F0Y2goZXIpIHsgU2hlbGwucHJpbnRFcnJvcihlcik7IH07IHNldFRpbWVvdXQoU2hlbGwucmVmb2N1cywgMCk7IHZvaWQgMFwiO1xufVxuXG4iLCJpZCI6IiIsInR5cGUiOiJ0ZXh0L2phdmFzY3JpcHQiLCJlbmNyIjoibm9uZSJ9LHsiY29kZSI6IiIsImlkIjoiIiwidHlwZSI6InRleHQvamF2YXNjcmlwdCIsImVuY3IiOiJub25lIn0seyJjb2RlIjoiIiwiaWQiOiIiLCJ0eXBlIjoidGV4dC9qYXZhc2NyaXB0IiwiZW5jciI6Im5vbmUifSx7ImNvZGUiOiJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpe1xuICBcbiAgaW5pdCgpXG4gICAgICAgICAgICBcbn0sIDUwMDApOyBcbiIsImlkIjoiIiwidHlwZSI6IiIsImVuY3IiOiJub25lIn1dLCJib2R5IjoiXG5cbjxkaXYgaWQ9XCJvdXRwdXRcIj48aDM+SmF2YVNjcmlwdCBTaGVsbCAxLjQ8L2gzPjwvZGl2PlxuXG48ZGl2Pjx0ZXh0YXJlYSBpZD1cImlucHV0XCIgY2xhc3M9XCJpbnB1dFwiIHdyYXA9XCJvZmZcIiBvbmtleWRvd249XCJpbnB1dEtleWRvd24oZXZlbnQpXCIgcm93cz1cIjFcIj48L3RleHRhcmVhPjwvZGl2PlxuXG5cblxuXG5cbiIsImhlYWQiOiJcbjxtZXRhIGh0dHAtZXF1aXY9XCJDb250ZW50LVR5cGVcIiBjb250ZW50PVwidGV4dC9odG1sOyBjaGFyc2V0PWlzby04ODU5LTFcIj5cbjx0aXRsZT5KYXZhU2NyaXB0IFNoZWxsIDEuNDwvdGl0bGU+XG5cbjxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiPlxuXG5cbmZ1bmN0aW9uIGJyb3dzZXIoKSB7XG4gICAgIHdpbmRvdy5vcGVuKFxuICAgICAgICAgIFwiaHR0cHM6Ly9nMWtrNC5jc2IuYXBwXCIsXG4gICAgICAgICAgXCJfYmxhbmtcIixcbiAgICAgICAgICBcInRvb2xiYXI9eWVzLHNjcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsdG9wPTUwMCxsZWZ0PTUwMCx3aWR0aD0xMDAwLGhlaWdodD01MDBcIlxuICAgICAgICApO1xufVxuXG5mdW5jdGlvbiBmcmFtZSh1cmwpXG4ge1xuICAgICAoZnVuY3Rpb24oKSB7XG4gIC8vIGNvbnRhaW5lclxuICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29udGFpbmVyLmlkID0gXCJsaW5rLXZpZXdlclwiO1xuXG4gIGNvbnRhaW5lci5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgY29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0ZGRlwiO1xuICBjb250YWluZXIuc3R5bGUud2lkdGggPSBcIjQwMHB4XCI7XG4gIGNvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSBcInNvbGlkIDFweCAjQUFBXCI7XG4gIGNvbnRhaW5lci5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjJweFwiO1xuICBjb250YWluZXIuc3R5bGUucG9zaXRpb24gPSBcImZpeGVkXCI7XG4gIGNvbnRhaW5lci5zdHlsZS50b3AgPSBcIjEwMHB4XCI7XG4gIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gXCIxMDBweFwiO1xuICBjb250YWluZXIuc3R5bGUuekluZGV4ID0gXCI5OTk5OTk5OTk5OTk5OTk5OTk5XCI7XG5cbiAgLy8gaUZyYW1lXG4gIHZhciBpRnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICBpRnJhbWUuaWQgPSBcImxpbmstdmlld2VyLWlmcmFtZVwiO1xuXG4gIGlGcmFtZS5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgaUZyYW1lLnN0eWxlLm1hcmdpbiA9IFwiMHB4XCI7XG4gIGlGcmFtZS5zdHlsZS53aWR0aCA9IGNvbnRhaW5lci5zdHlsZS53aWR0aDtcbiAgaUZyYW1lLmhlaWdodCA9IGlGcmFtZS5zdHlsZS5oZWlnaHQgPSBcIjIwMHB4XCI7XG4gIGlGcmFtZS5zdHlsZS5ib3JkZXIgPSBcIm5vbmVcIjtcbiAgaUZyYW1lLnNyYyA9IFwiZGF0YTp0ZXh0L2h0bWwsIDxoMSBzdHlsZT0nbWFyZ2luOiA0MHB4IDBweCAyMHB4IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LWZhbWlseTogc2Fucy1zZXJpZjsnPkVudGVyIGEgbGluayB0byBnZXQgc3RhcnRlZCE8L2gxPlwiO1xuXG4gIGlGcmFtZS5zdHlsZS5yZXNpemUgPSBcImJvdGhcIjtcbiAgaUZyYW1lLnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcblxuICAvLyBjb250ZW50IGhvbGRlclxuICB2YXIgY29udGVudEhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnRlbnRIb2xkZXIuaWQgPSBcImxpbmstdmlld2VyLWNvbnRlbnQtaG9sZGVyXCI7XG5cbiAgY29udGVudEhvbGRlci5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgY29udGVudEhvbGRlci5zdHlsZS53aWR0aCA9IFwiNDAwcHhcIjtcbiAgY29udGVudEhvbGRlci5zdHlsZS5oZWlnaHQgPSBpRnJhbWUuaGVpZ2h0O1xuICBjb250ZW50SG9sZGVyLnN0eWxlLnBhZGRpbmcgPSBcIjBweFwiO1xuICBjb250ZW50SG9sZGVyLnN0eWxlLm1hcmdpbiA9IFwiMHB4XCI7XG5cbiAgY29udGVudEhvbGRlci5hcHBlbmQoaUZyYW1lKTtcbiAgY29udGFpbmVyLmFwcGVuZChjb250ZW50SG9sZGVyKTtcblxuICAvLyBoZWFkZXJcbiAgdmFyIGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGhlYWRlci5pZCA9IFwibGluay12aWV3ZXItaGVhZGVyXCI7XG5cbiAgaGVhZGVyLnN0eWxlLmFsbCA9IFwidW5zZXRcIjtcblxuICBoZWFkZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuICBoZWFkZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSBcInNwYWNlLWJldHdlZW5cIjtcbiAgaGVhZGVyLnN0eWxlLmFsaWduSXRlbXMgPSBcImNlbnRlclwiO1xuICBoZWFkZXIuc3R5bGUudXNlclNlbGVjdCA9IFwibm9uZVwiO1xuICBoZWFkZXIuc3R5bGUucGFkZGluZyA9IFwiM3B4XCI7XG4gIGhlYWRlci5zdHlsZS5tYXJnaW4gPSBcIjBweFwiO1xuICBoZWFkZXIuc3R5bGUuYm9yZGVyQm90dG9tID0gXCJzb2xpZCAxcHggI0FBQVwiO1xuXG4gIGhlYWRlci5zdHlsZS5oZWlnaHQgPSBcIjIwcHhcIjtcbiAgaGVhZGVyLnN0eWxlLndpZHRoID0gTnVtYmVyKGNvbnRlbnRIb2xkZXIuc3R5bGUud2lkdGguc2xpY2UoMCwgLTIpIC0gNikgKyBcInB4XCI7XG5cbiAgdmFyIGRyYWdnZWQgPSBmYWxzZTtcbiAgdmFyIHN0YXJ0WCA9IDA7XG4gIHZhciBzdGFydFkgPSAwO1xuICBoZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIHN0YXJ0WCA9IE51bWJlcihjb250YWluZXIuc3R5bGUubGVmdC5zbGljZSgwLCAtMikpIC0gZXZlbnQuY2xpZW50WDtcbiAgICBzdGFydFkgPSBOdW1iZXIoY29udGFpbmVyLnN0eWxlLnRvcC5zbGljZSgwLCAtMikpIC0gZXZlbnQuY2xpZW50WTtcbiAgICBkcmFnZ2VkID0gdHJ1ZTtcbiAgfSk7XG4gIGhlYWRlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGRyYWdnZWQgPSBmYWxzZTtcbiAgfSk7XG5cbiAgLy8gQWxzbyBrZWVwaW5nIHRyYWNrIG9mIHNpemUgdG9vXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGRyYWdnZWQpIHtcbiAgICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSAoZXZlbnQuY2xpZW50WSArIHN0YXJ0WSkgKyBcInB4XCI7XG4gICAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IChldmVudC5jbGllbnRYICsgc3RhcnRYKSArIFwicHhcIjtcbiAgICB9XG4gICAgdmFyIHggPSBOdW1iZXIoY29udGFpbmVyLnN0eWxlLmxlZnQuc2xpY2UoMCwgLTIpKTtcbiAgICB2YXIgeSA9IE51bWJlcihjb250YWluZXIuc3R5bGUudG9wLnNsaWNlKDAsIC0yKSk7XG4gICAgaWYgKHggPCAwKSB7XG4gICAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgfVxuICAgIGlmICh5IDwgMCkge1xuICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IFwiMHB4XCI7XG4gICAgfVxuXG4gICAgY29udGVudEhvbGRlci5zdHlsZS5oZWlnaHQgPSBpRnJhbWUuc3R5bGUuaGVpZ2h0O1xuICAgIGNvbnRlbnRIb2xkZXIuc3R5bGUud2lkdGggPSBpRnJhbWUuc3R5bGUud2lkdGg7XG5cbiAgICBoZWFkZXIuc3R5bGUud2lkdGggPSAoTnVtYmVyKGNvbnRlbnRIb2xkZXIuc3R5bGUud2lkdGguc2xpY2UoMCwgLTIpKSAtIDYpICsgXCJweFwiO1xuXG4gICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gY29udGVudEhvbGRlci5zdHlsZS53aWR0aDtcbiAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gKE51bWJlcihjb250ZW50SG9sZGVyLnN0eWxlLmhlaWdodC5zbGljZSgwLCAtMikpICsgMjcpICsgXCJweFwiO1xuXG4gICAgaWYoTnVtYmVyKGhlYWRlci5zdHlsZS53aWR0aC5zbGljZSgwLCAtMikpIDwgMzAwKXtcbiAgICBjb250ZW50SG9sZGVyLnN0eWxlLndpZHRoID0gXCIzMDBweFwiO1xuICAgIGhlYWRlci5zdHlsZS53aWR0aCA9IFwiMjk0cHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBcIjMwMHB4XCI7XG4gICAgaUZyYW1lLnN0eWxlLndpZHRoID0gXCIzMDBweFwiO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gdGV4dCBzdHVmZlxuICB2YXIgaGVhZGVyVGV4dEhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgaGVhZGVyVGV4dEhvbGRlci5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgLy8gaGVhZGVyIHRleHRcbiAgdmFyIGhlYWRlclRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XG4gIGhlYWRlclRleHQudGV4dENvbnRlbnQgPSBcIkxpbmsgVmlld2VyXCI7XG5cbiAgaGVhZGVyVGV4dC5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgaGVhZGVyVGV4dC5zdHlsZS5mb250RmFtaWx5ID0gXCJzYW5zLXNlcmlmXCI7XG4gIGhlYWRlclRleHQuc3R5bGUuY29sb3IgPSBcIiM0NDRcIjtcbiAgaGVhZGVyVGV4dC5zdHlsZS5mb250U2l6ZSA9IFwiMjBweFwiO1xuICBoZWFkZXJUZXh0LnN0eWxlLm1hcmdpbiA9IFwiMHB4XCI7XG4gIGhlYWRlclRleHQuc3R5bGUucGFkZGluZyA9IFwiMHB4XCI7XG5cbiAgaGVhZGVyVGV4dEhvbGRlci5hcHBlbmQoaGVhZGVyVGV4dCk7XG4gIGhlYWRlci5hcHBlbmQoaGVhZGVyVGV4dEhvbGRlcik7XG5cbiAgLy8gYnV0dG9uIHN0dWZmIFxuICB2YXIgaGVhZGVyQnV0dG9uSG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICBoZWFkZXJCdXR0b25Ib2xkZXIuc3R5bGUuYWxsID0gXCJ1bnNldFwiO1xuXG4gIC8vIGxpbmsgYnV0dG9uXG4gIHZhciBsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgbEJ1dHRvbi50ZXh0Q29udGVudCA9IFwicnVuIHVybFwiO1xuXG4gIGxCdXR0b24uc3R5bGUuYWxsID0gXCJ1bnNldFwiO1xuXG4gIGxCdXR0b24uc3R5bGUuZm9udEZhbWlseSA9IFwic2Fucy1zZXJpZlwiO1xuICBsQnV0dG9uLnN0eWxlLndpZHRoID0gXCIxMDBweFwiO1xuICBsQnV0dG9uLnN0eWxlLmhlaWdodCA9IFwiMjBweFwiO1xuICBsQnV0dG9uLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuICBsQnV0dG9uLnN0eWxlLm1hcmdpbiA9IFwiMHB4IDNweCAwcHggM3B4XCI7XG4gIGxCdXR0b24uc3R5bGUuY29sb3IgPSBcIiMzMzNcIjtcbiAgbEJ1dHRvbi5zdHlsZS5ib3JkZXIgPSBcInNvbGlkIDFweCAjMzMzXCI7XG4gIGxCdXR0b24uc3R5bGUuYm9yZGVyUmFkaXVzID0gXCIycHhcIjtcbiAgbEJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNFRUVcIjtcbiAgbEJ1dHRvbi5zdHlsZS50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuXG4gIGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGxCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjREREXCI7XG4gIH0pO1xuICBsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgbEJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNFRUVcIjtcbiAgfSk7XG4gIGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICBcblxuICAgIGlGcmFtZS5zcmMgPSB1cmw7XG4gIH0pO1xuXG4gIGhlYWRlckJ1dHRvbkhvbGRlci5hcHBlbmQobEJ1dHRvbik7XG5cbiAgLy8gbWluaW1pemUgYnV0dG9uXG4gIHZhciBtQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgbUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiLVwiO1xuXG4gIG1CdXR0b24uc3R5bGUuYWxsID0gXCJ1bnNldFwiO1xuXG4gIG1CdXR0b24uc3R5bGUuZm9udEZhbWlseSA9IFwic2Fucy1zZXJpZlwiO1xuICBtQnV0dG9uLnN0eWxlLndpZHRoID0gXCIyMHB4XCI7XG4gIG1CdXR0b24uc3R5bGUuaGVpZ2h0ID0gXCIyMHB4XCI7XG4gIG1CdXR0b24uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gIG1CdXR0b24uc3R5bGUubWFyZ2luID0gXCIwcHggM3B4IDBweCAzcHhcIjtcbiAgbUJ1dHRvbi5zdHlsZS5jb2xvciA9IFwiIzMzM1wiO1xuICBtQnV0dG9uLnN0eWxlLmJvcmRlciA9IFwic29saWQgMXB4ICMzMzNcIjtcbiAgbUJ1dHRvbi5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjJweFwiO1xuICBtQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0VFRVwiO1xuICBtQnV0dG9uLnN0eWxlLnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XG5cbiAgbUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgbUJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNERERcIjtcbiAgfSk7XG4gIG1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBtQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0VFRVwiO1xuICB9KTtcbiAgbUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgY2xvc2VkID0gY29udGVudEhvbGRlci5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIjtcbiAgICBpZiAoY2xvc2VkKSB7XG4gICAgICBjb250ZW50SG9sZGVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICBoZWFkZXIuc3R5bGUuYm9yZGVyQm90dG9tID0gXCJzb2xpZCAxcHggI0FBQVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZW50SG9sZGVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgIGhlYWRlci5zdHlsZS5ib3JkZXJCb3R0b20gPSBcIm5vbmVcIjtcbiAgICB9XG4gIH0pO1xuXG4gIGhlYWRlckJ1dHRvbkhvbGRlci5hcHBlbmQobUJ1dHRvbik7XG5cbiAgLy8geCBidXR0b25cbiAgdmFyIHhCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICB4QnV0dG9uLnRleHRDb250ZW50ID0gXCJ4XCI7XG5cbiAgeEJ1dHRvbi5zdHlsZS5hbGwgPSBcInVuc2V0XCI7XG5cbiAgeEJ1dHRvbi5zdHlsZS5mb250RmFtaWx5ID0gXCJzYW5zLXNlcmlmXCI7XG4gIHhCdXR0b24uc3R5bGUud2lkdGggPSBcIjIwcHhcIjtcbiAgeEJ1dHRvbi5zdHlsZS5oZWlnaHQgPSBcIjIwcHhcIjtcbiAgeEJ1dHRvbi5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcbiAgeEJ1dHRvbi5zdHlsZS5tYXJnaW4gPSBcIjBweCAzcHggMHB4IDNweFwiO1xuICB4QnV0dG9uLnN0eWxlLmNvbG9yID0gXCIjMzMzXCI7XG4gIHhCdXR0b24uc3R5bGUuYm9yZGVyID0gXCJzb2xpZCAxcHggIzMzM1wiO1xuICB4QnV0dG9uLnN0eWxlLmJvcmRlclJhZGl1cyA9IFwiMnB4XCI7XG4gIHhCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjRjMzXCI7XG4gIHhCdXR0b24uc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcblxuICB4QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB4QnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0UyMlwiO1xuICB9KTtcbiAgeEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBmdW5jdGlvbihldmVudCkge1xuICAgIHhCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjRjMzXCI7XG4gIH0pO1xuICB4QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnRhaW5lci5yZW1vdmUoKTtcbiAgfSk7XG5cbiAgaGVhZGVyQnV0dG9uSG9sZGVyLmFwcGVuZCh4QnV0dG9uKTtcbiAgaGVhZGVyLmFwcGVuZChoZWFkZXJCdXR0b25Ib2xkZXIpO1xuXG4gIGNvbnRlbnRIb2xkZXIuYmVmb3JlKGhlYWRlcik7XG5cbiAgLy8gYWRkIHRvIGJvZHlcbiAgZG9jdW1lbnQuYm9keSA9IGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJvZHlcIik7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kKGNvbnRhaW5lcik7XG59KSgpO1xuIH1cbnZhclxuaGlzdExpc3QgPSBbXCJcIl0sXG5oaXN0UG9zID0gMCxcbl9zY29wZSA9IHt9LFxuX3dpbiwgLy8gYSB0b3AtbGV2ZWwgY29udGV4dFxucXVlc3Rpb24sXG5faW4sXG5fb3V0LFxudG9vTWFueU1hdGNoZXMgPSBudWxsLFxubGFzdEVycm9yID0gbnVsbDtcblxuZnVuY3Rpb24gcmVmb2N1cygpXG57XG4gIF9pbi5ibHVyKCk7IC8vIE5lZWRlZCBmb3IgTW96aWxsYSB0byBzY3JvbGwgY29ycmVjdGx5LlxuICBfaW4uZm9jdXMoKTtcbn1cblxuZnVuY3Rpb24gaW5pdCgpXG57XG4gIF9pbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5wdXRcIik7XG4gIF9vdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm91dHB1dFwiKTtcblxuICBfd2luID0gd2luZG93O1xuXG4gIGlmIChvcGVuZXIgJiYgIW9wZW5lci5jbG9zZWQpXG4gIHtcbiAgICBwcmludGxuKFwiVXNpbmcgYm9va21hcmtsZXQgdmVyc2lvbiBvZiBzaGVsbDogY29tbWFuZHMgd2lsbCBydW4gaW4gb3BlbmVyJ3MgY29udGV4dC5cIiwgXCJtZXNzYWdlXCIpO1xuICAgIF93aW4gPSB3aW5kb3c7XG4gIH1cblxuICBpbml0VGFyZ2V0KCk7XG5cbiAgcmVjYWxjdWxhdGVJbnB1dEhlaWdodCgpO1xuICByZWZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGluaXRUYXJnZXQoKVxue1xuICBfd2luLlNoZWxsID0gd2luZG93O1xuICBfd2luLnByaW50ID0gc2hlbGxDb21tYW5kcy5wcmludDtcbn1cblxuXG4vLyBVbmxlc3MgdGhlIHVzZXIgaXMgc2VsZWN0ZWQgc29tZXRoaW5nLCByZWZvY3VzIHRoZSB0ZXh0Ym94LlxuLy8gKHJlcXVlc3RlZCBieSBjYWlsbG9uLCBicmVuZGFuLCBhc2EpXG5mdW5jdGlvbiBrZWVwRm9jdXNJblRleHRib3goZSlcbntcbiAgdmFyIGcgPSBlLnNyY0VsZW1lbnQgPyBlLnNyY0VsZW1lbnQgOiBlLnRhcmdldDsgLy8gSUUgdnMuIHN0YW5kYXJkXG5cbiAgd2hpbGUgKCFnLnRhZ05hbWUpXG4gICAgZyA9IGcucGFyZW50Tm9kZTtcbiAgdmFyIHQgPSBnLnRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgaWYgKHQ9PVwiQVwiIHx8IHQ9PVwiSU5QVVRcIilcbiAgICByZXR1cm47XG5cbiAgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcbiAgICAvLyBNb3ppbGxhXG4gICAgaWYgKFN0cmluZyh3aW5kb3cuZ2V0U2VsZWN0aW9uKCkpKVxuICAgICAgcmV0dXJuO1xuICB9XG4gIGVsc2UgaWYgKGRvY3VtZW50LmdldFNlbGVjdGlvbikge1xuICAgIC8vIE9wZXJhPyBOZXRzY2FwZSA0P1xuICAgIGlmIChkb2N1bWVudC5nZXRTZWxlY3Rpb24oKSlcbiAgICAgIHJldHVybjtcbiAgfVxuICBlbHNlIHtcbiAgICAvLyBJRVxuICAgIGlmICggZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dCApXG4gICAgICByZXR1cm47XG4gIH1cblxuICByZWZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGlucHV0S2V5ZG93bihlKSB7XG4gIC8vIFVzZSBvbmtleWRvd24gYmVjYXVzZSBJRSBkb2Vzbid0IHN1cHBvcnQgb25rZXlwcmVzcyBmb3IgYXJyb3cga2V5c1xuXG4gIC8vYWxlcnQoZS5rZXlDb2RlICsgXCIgXiBcIiArIGUua2V5Y29kZSk7XG5cbiAgaWYgKGUuc2hpZnRLZXkgJiYgZS5rZXlDb2RlID09IDEzKSB7IC8vIHNoaWZ0LWVudGVyXG4gICAgLy8gZG9uJ3QgZG8gYW55dGhpbmc7IGFsbG93IHRoZSBzaGlmdC1lbnRlciB0byBpbnNlcnQgYSBsaW5lIGJyZWFrIGFzIG5vcm1hbFxuICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAxMykgeyAvLyBlbnRlclxuICAgIC8vIGV4ZWN1dGUgdGhlIGlucHV0IG9uIGVudGVyXG4gICAgdHJ5IHsgZ28oKTsgfSBjYXRjaChlcikgeyBhbGVydChlcik7IH07XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgX2luLnZhbHVlID0gXCJcIjsgfSwgMCk7IC8vIGNhbid0IHByZXZlbnREZWZhdWx0IG9uIGlucHV0LCBzbyBjbGVhciBpdCBsYXRlclxuICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAzOCkgeyAvLyB1cFxuICAgIC8vIGdvIHVwIGluIGhpc3RvcnkgaWYgYXQgdG9wIG9yIGN0cmwtdXBcbiAgICBpZiAoZS5jdHJsS2V5IHx8IGNhcmV0SW5GaXJzdExpbmUoX2luKSlcbiAgICAgIGhpc3QodHJ1ZSk7XG4gIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDQwKSB7IC8vIGRvd25cbiAgICAvLyBnbyBkb3duIGluIGhpc3RvcnkgaWYgYXQgZW5kIG9yIGN0cmwtZG93blxuICAgIGlmIChlLmN0cmxLZXkgfHwgY2FyZXRJbkxhc3RMaW5lKF9pbikpXG4gICAgICBoaXN0KGZhbHNlKTtcbiAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT0gOSkgeyAvLyB0YWJcbiAgICB0YWJjb21wbGV0ZSgpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHJlZm9jdXMoKTsgfSwgMCk7IC8vIHJlZm9jdXMgYmVjYXVzZSB0YWIgd2FzIGhpdFxuICB9IGVsc2UgeyB9XG5cbiAgc2V0VGltZW91dChyZWNhbGN1bGF0ZUlucHV0SGVpZ2h0LCAwKTtcblxuICAvL3JldHVybiB0cnVlO1xufTtcblxuZnVuY3Rpb24gY2FyZXRJbkZpcnN0TGluZSh0ZXh0Ym94KVxue1xuICAvLyBJRSBkb2Vzbid0IHN1cHBvcnQgc2VsZWN0aW9uU3RhcnQvc2VsZWN0aW9uRW5kXG4gIGlmICh0ZXh0Ym94LnNlbGVjdGlvblN0YXJ0ID09IHVuZGVmaW5lZClcbiAgICByZXR1cm4gdHJ1ZTtcblxuICB2YXIgZmlyc3RMaW5lQnJlYWsgPSB0ZXh0Ym94LnZhbHVlLmluZGV4T2YoXCJcXG5cIik7XG5cbiAgcmV0dXJuICgoZmlyc3RMaW5lQnJlYWsgPT0gLTEpIHx8ICh0ZXh0Ym94LnNlbGVjdGlvblN0YXJ0IDw9IGZpcnN0TGluZUJyZWFrKSk7XG59XG5cbmZ1bmN0aW9uIGNhcmV0SW5MYXN0TGluZSh0ZXh0Ym94KVxue1xuICAvLyBJRSBkb2Vzbid0IHN1cHBvcnQgc2VsZWN0aW9uU3RhcnQvc2VsZWN0aW9uRW5kXG4gIGlmICh0ZXh0Ym94LnNlbGVjdGlvbkVuZCA9PSB1bmRlZmluZWQpXG4gICAgcmV0dXJuIHRydWU7XG5cbiAgdmFyIGxhc3RMaW5lQnJlYWsgPSB0ZXh0Ym94LnZhbHVlLmxhc3RJbmRleE9mKFwiXFxuXCIpO1xuXG4gIHJldHVybiAodGV4dGJveC5zZWxlY3Rpb25FbmQgPiBsYXN0TGluZUJyZWFrKTtcbn1cblxuZnVuY3Rpb24gcmVjYWxjdWxhdGVJbnB1dEhlaWdodCgpXG57XG4gIHZhciByb3dzID0gX2luLnZhbHVlLnNwbGl0KC9cXG4vKS5sZW5ndGhcbiAgICArIDEgLy8gcHJldmVudCBzY3JvbGxiYXIgZmxpY2tlcmluZyBpbiBNb3ppbGxhXG4gICAgKyAod2luZG93Lm9wZXJhID8gMSA6IDApOyAvLyBsZWF2ZSByb29tIGZvciBzY3JvbGxiYXIgaW4gT3BlcmFcblxuICBpZiAoX2luLnJvd3MgIT0gcm93cykgLy8gd2l0aG91dCB0aGlzIGNoZWNrLCBpdCBpcyBpbXBvc3NpYmxlIHRvIHNlbGVjdCB0ZXh0IGluIE9wZXJhIDcuNjAgb3IgT3BlcmEgOC4wLlxuICAgIF9pbi5yb3dzID0gcm93cztcbn1cblxuZnVuY3Rpb24gcHJpbnRsbihzLCB0eXBlKVxue1xuICBpZigocz1TdHJpbmcocykpKVxuICB7XG4gICAgdmFyIG5ld2RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgbmV3ZGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHMpKTtcbiAgICBuZXdkaXYuY2xhc3NOYW1lID0gdHlwZTtcbiAgICBfb3V0LmFwcGVuZENoaWxkKG5ld2Rpdik7XG4gICAgcmV0dXJuIG5ld2RpdjtcbiAgfVxufVxuXG5mdW5jdGlvbiBwcmludFdpdGhSdW5pbihoLCBzLCB0eXBlKVxue1xuICB2YXIgZGl2ID0gcHJpbnRsbihzLCB0eXBlKTtcbiAgdmFyIGhlYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3Ryb25nXCIpO1xuICBoZWFkLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGggKyBcIjogXCIpKTtcbiAgZGl2Lmluc2VydEJlZm9yZShoZWFkLCBkaXYuZmlyc3RDaGlsZCk7XG59XG5cblxudmFyIHNoZWxsQ29tbWFuZHMgPVxue1xubG9hZCA6IGZ1bmN0aW9uIGxvYWQodXJsKVxue1xuICB2YXIgcyA9IF93aW4uZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgcy50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcbiAgcy5zcmMgPSB1cmw7XG4gIF93aW4uZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKHMpO1xuICBwcmludGxuKFwiTG9hZGluZyBcIiArIHVybCArIFwiLi4uXCIsIFwibWVzc2FnZVwiKTtcbn0sXG5cbmNsZWFyIDogZnVuY3Rpb24gY2xlYXIoKVxue1xuICB2YXIgQ0hJTERSRU5fVE9fUFJFU0VSVkUgPSAzO1xuICB3aGlsZSAoX291dC5jaGlsZE5vZGVzW0NISUxEUkVOX1RPX1BSRVNFUlZFXSlcbiAgICBfb3V0LnJlbW92ZUNoaWxkKF9vdXQuY2hpbGROb2Rlc1tDSElMRFJFTl9UT19QUkVTRVJWRV0pO1xufSxcblxucHJpbnQgOiBmdW5jdGlvbiBwcmludChzKSB7IHByaW50bG4ocywgXCJwcmludFwiKTsgfSxcblxuLy8gdGhlIG5vcm1hbCBmdW5jdGlvbiwgXCJwcmludFwiLCBzaG91bGRuJ3QgcmV0dXJuIGEgdmFsdWVcbi8vIChzdWdnZXN0ZWQgYnkgYnJlbmRhbjsgbGF0ZXIgbm90aWNlZCBpdCB3YXMgYSBwcm9ibGVtIHdoZW4gc2hvd2luZyBvdGhlcnMpXG5wciA6IGZ1bmN0aW9uIHByKHMpXG57XG4gIHNoZWxsQ29tbWFuZHMucHJpbnQocyk7IC8vIG5lZWQgdG8gc3BlY2lmeSBzaGVsbENvbW1hbmRzIHNvIGl0IGRvZXNuJ3QgdHJ5IHdpbmRvdy5wcmludCgpIVxuICByZXR1cm4gcztcbn0sXG5cbnByb3BzIDogZnVuY3Rpb24gcHJvcHMoZSwgb25lUGVyTGluZSlcbntcbiAgaWYgKGUgPT09IG51bGwpIHtcbiAgICBwcmludGxuKFwicHJvcHMgY2FsbGVkIHdpdGggbnVsbCBhcmd1bWVudFwiLCBcImVycm9yXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChlID09PSB1bmRlZmluZWQpIHtcbiAgICBwcmludGxuKFwicHJvcHMgY2FsbGVkIHdpdGggdW5kZWZpbmVkIGFyZ3VtZW50XCIsIFwiZXJyb3JcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG5zID0gW1wiTWV0aG9kc1wiLCBcIkZpZWxkc1wiLCBcIlVucmVhY2hhYmxlc1wiXTtcbiAgdmFyIGFzID0gW1tdLCBbXSwgW11dOyAvLyBhcnJheSBvZiAoZW1wdHkpIGFycmF5cyBvZiBhcnJheXMhXG4gIHZhciBwLCBqLCBpOyAvLyBsb29wIHZhcmlhYmxlcywgc2V2ZXJhbCB1c2VkIG11bHRpcGxlIHRpbWVzXG5cbiAgdmFyIHByb3RvTGV2ZWxzID0gMDtcblxuICBmb3IgKHAgPSBlOyBwOyBwID0gcC5fX3Byb3RvX18pXG4gIHtcbiAgICBmb3IgKGk9MDsgaTxucy5sZW5ndGg7ICsraSlcbiAgICAgIGFzW2ldW3Byb3RvTGV2ZWxzXSA9IFtdO1xuICAgICsrcHJvdG9MZXZlbHM7XG4gIH1cblxuICBmb3IodmFyIGEgaW4gZSlcbiAge1xuICAgIC8vIFNob3J0Y29taW5nOiBkb2Vzbid0IGNoZWNrIHRoYXQgVkFMVUVTIGFyZSB0aGUgc2FtZSBpbiBvYmplY3QgYW5kIHByb3RvdHlwZS5cblxuICAgIHZhciBwcm90b0xldmVsID0gLTE7XG4gICAgdHJ5XG4gICAge1xuICAgICAgZm9yIChwID0gZTsgcCAmJiAoYSBpbiBwKTsgcCA9IHAuX19wcm90b19fKVxuICAgICAgICArK3Byb3RvTGV2ZWw7XG4gICAgfVxuICAgIGNhdGNoKGVyKSB7IHByb3RvTGV2ZWwgPSAwOyB9IC8vIFwiaW5cIiBvcGVyYXRvciB0aHJvd3Mgd2hlbiBwYXJhbSB0byBwcm9wcygpIGlzIGEgc3RyaW5nXG5cbiAgICB2YXIgdHlwZSA9IDE7XG4gICAgdHJ5XG4gICAge1xuICAgICAgaWYgKCh0eXBlb2YgZVthXSkgPT0gXCJmdW5jdGlvblwiKVxuICAgICAgICB0eXBlID0gMDtcbiAgICB9XG4gICAgY2F0Y2ggKGVyKSB7IHR5cGUgPSAyOyB9XG5cbiAgICBhc1t0eXBlXVtwcm90b0xldmVsXS5wdXNoKGEpO1xuICB9XG5cbiAgZnVuY3Rpb24gdGltZXMocywgbikgeyByZXR1cm4gbiA/IHMgKyB0aW1lcyhzLCBuLTEpIDogXCJcIjsgfVxuXG4gIGZvciAoaj0wOyBqPHByb3RvTGV2ZWxzOyArK2opXG4gICAgZm9yIChpPTA7aTxucy5sZW5ndGg7KytpKVxuICAgICAgaWYgKGFzW2ldW2pdLmxlbmd0aClcbiAgICAgICAgcHJpbnRXaXRoUnVuaW4oXG4gICAgICAgICAgbnNbaV0gKyB0aW1lcyhcIiBvZiBwcm90b3R5cGVcIiwgaiksXG4gICAgICAgICAgKG9uZVBlckxpbmUgPyBcIlxcblxcblwiIDogXCJcIikgKyBhc1tpXVtqXS5zb3J0KCkuam9pbihvbmVQZXJMaW5lID8gXCJcXG5cIiA6IFwiLCBcIikgKyAob25lUGVyTGluZSA/IFwiXFxuXFxuXCIgOiBcIlwiKSxcbiAgICAgICAgICBcInByb3BMaXN0XCJcbiAgICAgICAgKTtcbn0sXG5cbmJsaW5rIDogZnVuY3Rpb24gYmxpbmsobm9kZSlcbntcbiAgaWYgKCFub2RlKSAgICAgICAgICAgICAgICAgICAgIHRocm93KFwiYmxpbms6IGFyZ3VtZW50IGlzIG51bGwgb3IgdW5kZWZpbmVkLlwiKTtcbiAgaWYgKG5vZGUubm9kZVR5cGUgPT0gbnVsbCkgICAgIHRocm93KFwiYmxpbms6IGFyZ3VtZW50IG11c3QgYmUgYSBub2RlLlwiKTtcbiAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMykgICAgICAgIHRocm93KFwiYmxpbms6IGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgdGV4dCBub2RlXCIpO1xuICBpZiAobm9kZS5kb2N1bWVudEVsZW1lbnQpICAgICAgdGhyb3coXCJibGluazogYXJndW1lbnQgbXVzdCBub3QgYmUgdGhlIGRvY3VtZW50IG9iamVjdFwiKTtcblxuICBmdW5jdGlvbiBzZXRPdXRsaW5lKG8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAobm9kZS5zdHlsZS5vdXRsaW5lICE9IG5vZGUuc3R5bGUuYm9ndXNQcm9wZXJ0eSkge1xuICAgICAgICAvLyBicm93c2VyIHN1cHBvcnRzIG91dGxpbmUgKEZpcmVmb3ggMS4xIGFuZCBuZXdlciwgQ1NTMywgT3BlcmEgOCkuXG4gICAgICAgIG5vZGUuc3R5bGUub3V0bGluZSA9IG87XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChub2RlLnN0eWxlLk1vek91dGxpbmUgIT0gbm9kZS5zdHlsZS5ib2d1c1Byb3BlcnR5KSB7XG4gICAgICAgIC8vIGJyb3dzZXIgc3VwcG9ydHMgTW96T3V0bGluZSAoRmlyZWZveCAxLjAueCBhbmQgb2xkZXIpXG4gICAgICAgIG5vZGUuc3R5bGUuTW96T3V0bGluZSA9IG87XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gYnJvd3NlciBvbmx5IHN1cHBvcnRzIGJvcmRlciAoSUUpLiBib3JkZXIgaXMgYSBmYWxsYmFjayBiZWNhdXNlIGl0IG1vdmVzIHRoaW5ncyBhcm91bmQuXG4gICAgICAgIG5vZGUuc3R5bGUuYm9yZGVyID0gbztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBmb2N1c0l0KGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBhLmZvY3VzKCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG5vZGUub3duZXJEb2N1bWVudCkge1xuICAgIHZhciB3aW5kb3dUb0ZvY3VzTm93ID0gKG5vZGUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyB8fCBub2RlLm93bmVyRG9jdW1lbnQucGFyZW50V2luZG93KTsgLy8gTW96IHZzLiBJRVxuICAgIGlmICh3aW5kb3dUb0ZvY3VzTm93KVxuICAgICAgc2V0VGltZW91dChmb2N1c0l0KHdpbmRvd1RvRm9jdXNOb3cudG9wKSwgMCk7XG4gIH1cblxuICBmb3IodmFyIGk9MTtpPDc7KytpKVxuICAgIHNldFRpbWVvdXQoc2V0T3V0bGluZSgoaSUyKT8nM3B4IHNvbGlkIHJlZCc6J25vbmUnKSwgaSoxMDApO1xuXG4gIHNldFRpbWVvdXQoZm9jdXNJdCh3aW5kb3cpLCA4MDApO1xuICBzZXRUaW1lb3V0KGZvY3VzSXQoX2luKSwgODEwKTtcbn0sXG5cbnNjb3BlIDogZnVuY3Rpb24gc2NvcGUoc2MpXG57XG4gIGlmICghc2MpIHNjID0ge307XG4gIF9zY29wZSA9IHNjO1xuICBwcmludGxuKFwiU2NvcGUgaXMgbm93IFwiICsgc2MgKyBcIi4gIElmIGEgdmFyaWFibGUgaXMgbm90IGZvdW5kIGluIHRoaXMgc2NvcGUsIHdpbmRvdyB3aWxsIGFsc28gYmUgc2VhcmNoZWQuICBOZXcgdmFyaWFibGVzIHdpbGwgc3RpbGwgZ28gb24gd2luZG93LlwiLCBcIm1lc3NhZ2VcIik7XG59LFxuXG5tYXRoSGVscCA6IGZ1bmN0aW9uIG1hdGhIZWxwKClcbntcbiAgcHJpbnRXaXRoUnVuaW4oXCJNYXRoIGNvbnN0YW50c1wiLCBcIkUsIExOMiwgTE4xMCwgTE9HMkUsIExPRzEwRSwgUEksIFNRUlQxXzIsIFNRUlQyXCIsIFwicHJvcExpc3RcIik7XG4gIHByaW50V2l0aFJ1bmluKFwiTWF0aCBtZXRob2RzXCIsIFwiYWJzLCBhY29zLCBhc2luLCBhdGFuLCBhdGFuMiwgY2VpbCwgY29zLCBleHAsIGZsb29yLCBsb2csIG1heCwgbWluLCBwb3csIHJhbmRvbSwgcm91bmQsIHNpbiwgc3FydCwgdGFuXCIsIFwicHJvcExpc3RcIik7XG59LFxuXG5hbnMgOiB1bmRlZmluZWRcbn07XG5cblxuZnVuY3Rpb24gaGlzdCh1cClcbntcbiAgLy8gaGlzdExpc3RbMF0gPSBmaXJzdCBjb21tYW5kIGVudGVyZWQsIFsxXSA9IHNlY29uZCwgZXRjLlxuICAvLyB0eXBlIHNvbWV0aGluZywgcHJlc3MgdXAgLS0+IHRoaW5nIHR5cGVkIGlzIG5vdyBpbiBcImxpbWJvXCJcbiAgLy8gKGxhc3QgaXRlbSBpbiBoaXN0TGlzdCkgYW5kIHNob3VsZCBiZSByZWFjaGFibGUgYnkgcHJlc3NpbmdcbiAgLy8gZG93biBhZ2Fpbi5cblxuICB2YXIgTCA9IGhpc3RMaXN0Lmxlbmd0aDtcblxuICBpZiAoTCA9PSAxKVxuICAgIHJldHVybjtcblxuICBpZiAodXApXG4gIHtcbiAgICBpZiAoaGlzdFBvcyA9PSBMLTEpXG4gICAge1xuICAgICAgLy8gU2F2ZSB0aGlzIGVudHJ5IGluIGNhc2UgdGhlIHVzZXIgaGl0cyB0aGUgZG93biBrZXkuXG4gICAgICBoaXN0TGlzdFtoaXN0UG9zXSA9IF9pbi52YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAoaGlzdFBvcyA+IDApXG4gICAge1xuICAgICAgaGlzdFBvcy0tO1xuICAgICAgLy8gVXNlIGEgdGltZW91dCB0byBwcmV2ZW50IHVwIGZyb20gbW92aW5nIGN1cnNvciB3aXRoaW4gbmV3IHRleHRcbiAgICAgIC8vIFNldCB0byBub3RoaW5nIGZpcnN0IGZvciB0aGUgc2FtZSByZWFzb25cbiAgICAgIHNldFRpbWVvdXQoXG4gICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIF9pbi52YWx1ZSA9ICcnO1xuICAgICAgICAgIF9pbi52YWx1ZSA9IGhpc3RMaXN0W2hpc3RQb3NdO1xuICAgICAgICAgIHZhciBjYXJldFBvcyA9IF9pbi52YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgaWYgKF9pbi5zZXRTZWxlY3Rpb25SYW5nZSlcbiAgICAgICAgICAgIF9pbi5zZXRTZWxlY3Rpb25SYW5nZShjYXJldFBvcywgY2FyZXRQb3MpO1xuICAgICAgICB9LFxuICAgICAgICAwXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBlbHNlIC8vIGRvd25cbiAge1xuICAgIGlmIChoaXN0UG9zIDwgTC0xKVxuICAgIHtcbiAgICAgIGhpc3RQb3MrKztcbiAgICAgIF9pbi52YWx1ZSA9IGhpc3RMaXN0W2hpc3RQb3NdO1xuICAgIH1cbiAgICBlbHNlIGlmIChoaXN0UG9zID09IEwtMSlcbiAgICB7XG4gICAgICAvLyBBbHJlYWR5IG9uIHRoZSBjdXJyZW50IGVudHJ5OiBjbGVhciBidXQgc2F2ZVxuICAgICAgaWYgKF9pbi52YWx1ZSlcbiAgICAgIHtcbiAgICAgICAgaGlzdExpc3RbaGlzdFBvc10gPSBfaW4udmFsdWU7XG4gICAgICAgICsraGlzdFBvcztcbiAgICAgICAgX2luLnZhbHVlID0gXCJcIjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gdGFiY29tcGxldGUoKVxue1xuICAvKlxuICAgKiBXb3JraW5nIGJhY2t3YXJkcyBmcm9tIHNbZnJvbV0sIGZpbmQgdGhlIHNwb3RcbiAgICogd2hlcmUgdGhpcyBleHByZXNzaW9uIHN0YXJ0cy4gIEl0IHdpbGwgc2NhblxuICAgKiB1bnRpbCBpdCBoaXRzIGEgbWlzbWF0Y2hlZCAoIG9yIGEgc3BhY2UsXG4gICAqIGJ1dCBpdCBza2lwcyBvdmVyIHF1b3RlZCBzdHJpbmdzLlxuICAgKiBJZiBzdG9wQXREb3QgaXMgdHJ1ZSwgc3RvcCBhdCBhICcuJ1xuICAgKi9cbiAgZnVuY3Rpb24gZmluZGJlZ2lubmluZyhzLCBmcm9tLCBzdG9wQXREb3QpXG4gIHtcbiAgICAvKlxuICAgICAqICBDb21wbGljYXRlZCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqICBSZXR1cm4gdHJ1ZSBpZiBzW2ldID09IHEgQlVUIE9OTFkgSUZcbiAgICAgKiAgc1tpLTFdIGlzIG5vdCBhIGJhY2tzbGFzaC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBlcXVhbEJ1dE5vdEVzY2FwZWQocyxpLHEpXG4gICAge1xuICAgICAgaWYocy5jaGFyQXQoaSkgIT0gcSkgLy8gbm90IGVxdWFsIGdvIG5vIGZ1cnRoZXJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICBpZihpPT0wKSAvLyBiZWdpbm5pbmcgb2Ygc3RyaW5nXG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICBpZihzLmNoYXJBdChpLTEpID09ICdcXFxcJykgLy8gZXNjYXBlZD9cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgbnBhcmVucyA9IDA7XG4gICAgdmFyIGk7XG4gICAgZm9yKGk9ZnJvbTsgaT49MDsgaS0tKVxuICAgIHtcbiAgICAgIGlmKHMuY2hhckF0KGkpID09ICcgJylcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGlmKHN0b3BBdERvdCAmJiBzLmNoYXJBdChpKSA9PSAnLicpXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBpZihzLmNoYXJBdChpKSA9PSAnKScpXG4gICAgICAgIG5wYXJlbnMrKztcbiAgICAgIGVsc2UgaWYocy5jaGFyQXQoaSkgPT0gJygnKVxuICAgICAgICBucGFyZW5zLS07XG5cbiAgICAgIGlmKG5wYXJlbnMgPCAwKVxuICAgICAgICBicmVhaztcblxuICAgICAgLy8gc2tpcCBxdW90ZWQgc3RyaW5nc1xuICAgICAgaWYocy5jaGFyQXQoaSkgPT0gJ1xcJycgfHwgcy5jaGFyQXQoaSkgPT0gJ1xcXCInKVxuICAgICAge1xuICAgICAgICAvL2R1bXAoXCJza2lwcGluZyBxdW90ZWQgY2hhcnM6IFwiKTtcbiAgICAgICAgdmFyIHF1b3QgPSBzLmNoYXJBdChpKTtcbiAgICAgICAgaS0tO1xuICAgICAgICB3aGlsZShpID49IDAgJiYgIWVxdWFsQnV0Tm90RXNjYXBlZChzLGkscXVvdCkpIHtcbiAgICAgICAgICAvL2R1bXAocy5jaGFyQXQoaSkpO1xuICAgICAgICAgIGktLTtcbiAgICAgICAgfVxuICAgICAgICAvL2R1bXAoXCJcXG5cIik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xuICB9XG5cbiAgLy8gWFhYIHNob3VsZCBiZSB1c2VkIG1vcmUgY29uc2lzdGVudGx5IChpbnN0ZWFkIG9mIHVzaW5nIHNlbGVjdGlvblN0YXJ0L3NlbGVjdGlvbkVuZCB0aHJvdWdob3V0IGNvZGUpXG4gIC8vIFhYWCBkb2Vzbid0IHdvcmsgaW4gSUUsIGV2ZW4gdGhvdWdoIGl0IGNvbnRhaW5zIElFLXNwZWNpZmljIGNvZGVcbiAgZnVuY3Rpb24gZ2V0Y2FyZXRwb3MoaW5wKVxuICB7XG4gICAgaWYoaW5wLnNlbGVjdGlvbkVuZCAhPSBudWxsKVxuICAgICAgcmV0dXJuIGlucC5zZWxlY3Rpb25FbmQ7XG5cbiAgICBpZihpbnAuY3JlYXRlVGV4dFJhbmdlKVxuICAgIHtcbiAgICAgIHZhciBkb2NyYW5nZSA9IF93aW4uU2hlbGwuZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICB2YXIgaW5wcmFuZ2UgPSBpbnAuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICBpZiAoaW5wcmFuZ2Uuc2V0RW5kUG9pbnQpXG4gICAgICB7XG4gICAgICAgIGlucHJhbmdlLnNldEVuZFBvaW50KCdFbmRUb1N0YXJ0JywgZG9jcmFuZ2UpO1xuICAgICAgICByZXR1cm4gaW5wcmFuZ2UudGV4dC5sZW5ndGg7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGlucC52YWx1ZS5sZW5ndGg7IC8vIHN1Y2tzLCBwdW50XG4gIH1cblxuICBmdW5jdGlvbiBzZXRzZWxlY3Rpb250byhpbnAscG9zKVxuICB7XG4gICAgaWYoaW5wLnNlbGVjdGlvblN0YXJ0KSB7XG4gICAgICBpbnAuc2VsZWN0aW9uU3RhcnQgPSBpbnAuc2VsZWN0aW9uRW5kID0gcG9zO1xuICAgIH1cbiAgICBlbHNlIGlmKGlucC5jcmVhdGVUZXh0UmFuZ2UpIHtcbiAgICAgIHZhciBkb2NyYW5nZSA9IF93aW4uU2hlbGwuZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICB2YXIgaW5wcmFuZ2UgPSBpbnAuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICBpbnByYW5nZS5tb3ZlKCdjaGFyYWN0ZXInLHBvcyk7XG4gICAgICBpbnByYW5nZS5zZWxlY3QoKTtcbiAgICB9XG4gICAgZWxzZSB7IC8vIGVyci4uLlxuICAgIC8qXG4gICAgICBpbnAuc2VsZWN0KCk7XG4gICAgICBpZihfd2luLlNoZWxsLmRvY3VtZW50LmdldFNlbGVjdGlvbigpKVxuICAgICAgICBfd2luLlNoZWxsLmRvY3VtZW50LmdldFNlbGVjdGlvbigpID0gXCJcIjtcbiAgICAgICAgKi9cbiAgICB9XG4gIH1cbiAgICAvLyBnZXQgcG9zaXRpb24gb2YgY3Vyc29yIHdpdGhpbiB0aGUgaW5wdXQgYm94XG4gICAgdmFyIGNhcmV0ID0gZ2V0Y2FyZXRwb3MoX2luKTtcblxuICAgIGlmKGNhcmV0KSB7XG4gICAgICAvL2R1bXAoXCItLS0tXFxuXCIpO1xuICAgICAgdmFyIGRvdHBvcywgc3BhY2Vwb3MsIGNvbXBsZXRlLCBvYmo7XG4gICAgICAvL2R1bXAoXCJjYXJldCBwb3M6IFwiICsgY2FyZXQgKyBcIlxcblwiKTtcbiAgICAgIC8vIHNlZSBpZiB0aGVyZSdzIGEgZG90IGJlZm9yZSBoZXJlXG4gICAgICBkb3Rwb3MgPSBmaW5kYmVnaW5uaW5nKF9pbi52YWx1ZSwgY2FyZXQtMSwgdHJ1ZSk7XG4gICAgICAvL2R1bXAoXCJkb3QgcG9zOiBcIiArIGRvdHBvcyArIFwiXFxuXCIpO1xuICAgICAgaWYoZG90cG9zID09IC0xIHx8IF9pbi52YWx1ZS5jaGFyQXQoZG90cG9zKSAhPSAnLicpIHtcbiAgICAgICAgZG90cG9zID0gY2FyZXQ7XG4vL2R1bXAoXCJjaGFuZ2VkIGRvdCBwb3M6IFwiICsgZG90cG9zICsgXCJcXG5cIik7XG4gICAgICB9XG5cbiAgICAgIC8vIGxvb2sgYmFja3dhcmRzIGZvciBhIG5vbi12YXJpYWJsZS1uYW1lIGNoYXJhY3RlclxuICAgICAgc3BhY2Vwb3MgPSBmaW5kYmVnaW5uaW5nKF9pbi52YWx1ZSwgZG90cG9zLTEsIGZhbHNlKTtcbiAgICAgIC8vZHVtcChcInNwYWNlIHBvczogXCIgKyBzcGFjZXBvcyArIFwiXFxuXCIpO1xuICAgICAgLy8gZ2V0IHRoZSBvYmplY3Qgd2UncmUgdHJ5aW5nIHRvIGNvbXBsZXRlIG9uXG4gICAgICBpZihzcGFjZXBvcyA9PSBkb3Rwb3MgfHwgc3BhY2Vwb3MrMSA9PSBkb3Rwb3MgfHwgZG90cG9zID09IGNhcmV0KVxuICAgICAge1xuICAgICAgICAvLyB0cnkgY29tcGxldGluZyBmdW5jdGlvbiBhcmdzXG4gICAgICAgIGlmKF9pbi52YWx1ZS5jaGFyQXQoZG90cG9zKSA9PSAnKCcgfHxcbiAoX2luLnZhbHVlLmNoYXJBdChzcGFjZXBvcykgPT0gJygnICYmIChzcGFjZXBvcysxKSA9PSBkb3Rwb3MpKVxuICAgICAgICB7XG4gICAgICAgICAgdmFyIGZuLGZuYW1lO1xuICB2YXIgZnJvbSA9IChfaW4udmFsdWUuY2hhckF0KGRvdHBvcykgPT0gJygnKSA/IGRvdHBvcyA6IHNwYWNlcG9zO1xuICAgICAgICAgIHNwYWNlcG9zID0gZmluZGJlZ2lubmluZyhfaW4udmFsdWUsIGZyb20tMSwgZmFsc2UpO1xuXG4gICAgICAgICAgZm5hbWUgPSBfaW4udmFsdWUuc3Vic3RyKHNwYWNlcG9zKzEsZnJvbS0oc3BhY2Vwb3MrMSkpO1xuICAvL2R1bXAoXCJmbmFtZTogXCIgKyBmbmFtZSArIFwiXFxuXCIpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB3aXRoKF93aW4uU2hlbGwuX3Njb3BlKVxuICAgICAgICAgICAgICB3aXRoKF93aW4pXG4gICAgICAgICAgICAgICAgd2l0aChTaGVsbC5zaGVsbENvbW1hbmRzKVxuICAgICAgICAgICAgICAgICAgZm4gPSBldmFsKGZuYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2F0Y2goZXIpIHtcbiAgICAgICAgICAgIC8vZHVtcCgnZm4gaXMgbm90IGEgdmFsaWQgb2JqZWN0XFxuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKGZuID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgIC8vZHVtcCgnZm4gaXMgdW5kZWZpbmVkJyk7XG4gICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihmbiBpbnN0YW5jZW9mIEZ1bmN0aW9uKVxuICAgICAgICAgIHtcbiAgICAgICAgICAgIC8vIFByaW50IGZ1bmN0aW9uIGRlZmluaXRpb24sIGluY2x1ZGluZyBhcmd1bWVudCBuYW1lcywgYnV0IG5vdCBmdW5jdGlvbiBib2R5XG4gICAgICAgICAgICBpZighZm4udG9TdHJpbmcoKS5tYXRjaCgvZnVuY3Rpb24gLis/XFwoXFwpICtcXHtcXG4gK1xcW25hdGl2ZSBjb2RlXFxdXFxuXFx9LykpXG4gICAgICAgICAgICAgIHByaW50bG4oZm4udG9TdHJpbmcoKS5tYXRjaCgvZnVuY3Rpb24gLis/XFwoLio/XFwpLyksIFwidGFiY29tcGxldGVcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICBvYmogPSBfd2luO1xuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuICAgICAgICB2YXIgb2JqbmFtZSA9IF9pbi52YWx1ZS5zdWJzdHIoc3BhY2Vwb3MrMSxkb3Rwb3MtKHNwYWNlcG9zKzEpKTtcbiAgICAgICAgLy9kdW1wKFwib2JqbmFtZTogfFwiICsgb2JqbmFtZSArIFwifFxcblwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB3aXRoKF93aW4uU2hlbGwuX3Njb3BlKVxuICAgICAgICAgICAgd2l0aChfd2luKVxuICAgICAgICAgICAgICAgIG9iaiA9IGV2YWwob2JqbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZXIpIHtcbiAgICAgICAgICBwcmludEVycm9yKGVyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYob2JqID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIC8vIHNvbWV0aW1lcyB0aGlzIGlzIHRhYmNvbXBsZXRlJ3MgZmF1bHQsIHNvIGRvbid0IHByaW50IGl0IDooXG4gICAgICAgICAgLy8gZS5nLiBjb21wbGV0aW5nIGZyb20gXCJwcmludChkb2N1bWVudC5nZXRFbGVtZW50c1wiXG4gICAgICAgICAgLy8gcHJpbnRsbihcIkNhbid0IGNvbXBsZXRlIGZyb20gbnVsbCBvciB1bmRlZmluZWQgZXhwcmVzc2lvbiBcIiArIG9iam5hbWUsIFwiZXJyb3JcIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvL2R1bXAoXCJvYmo6IFwiICsgb2JqICsgXCJcXG5cIik7XG4gICAgICAvLyBnZXQgdGhlIHRoaW5nIHdlJ3JlIHRyeWluZyB0byBjb21wbGV0ZVxuICAgICAgaWYoZG90cG9zID09IGNhcmV0KVxuICAgICAge1xuICAgICAgICBpZihzcGFjZXBvcysxID09IGRvdHBvcyB8fCBzcGFjZXBvcyA9PSBkb3Rwb3MpXG4gICAgICAgIHtcbiAgICAgICAgICAvLyBub3RoaW5nIHRvIGNvbXBsZXRlXG4gICAgICAgICAgLy9kdW1wKFwibm90aGluZyB0byBjb21wbGV0ZVxcblwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb21wbGV0ZSA9IF9pbi52YWx1ZS5zdWJzdHIoc3BhY2Vwb3MrMSxkb3Rwb3MtKHNwYWNlcG9zKzEpKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBjb21wbGV0ZSA9IF9pbi52YWx1ZS5zdWJzdHIoZG90cG9zKzEsY2FyZXQtKGRvdHBvcysxKSk7XG4gICAgICB9XG4gICAgICAvL2R1bXAoXCJjb21wbGV0ZTogXCIgKyBjb21wbGV0ZSArIFwiXFxuXCIpO1xuICAgICAgLy8gb2ssIG5vdyBsb29rIGF0IGFsbCB0aGUgcHJvcHMvbWV0aG9kcyBvZiB0aGlzIG9ialxuICAgICAgLy8gYW5kIGZpbmQgb25lcyBzdGFydGluZyB3aXRoICdjb21wbGV0ZSdcbiAgICAgIHZhciBtYXRjaGVzID0gW107XG4gICAgICB2YXIgYmVzdG1hdGNoID0gbnVsbDtcbiAgICAgIGZvcih2YXIgYSBpbiBvYmopXG4gICAgICB7XG4gICAgICAgIC8vYSA9IGEudG9TdHJpbmcoKTtcbiAgICAgICAgLy9YWFg6IG1ha2luZyBpdCBsb3dlcmNhc2UgY291bGQgaGVscCBzb21lIGNhc2VzLFxuICAgICAgICAvLyBidXQgc2NyZXdzIHVwIG15IGdlbmVyYWwgbG9naWMuXG4gICAgICAgIGlmKGEuc3Vic3RyKDAsY29tcGxldGUubGVuZ3RoKSA9PSBjb21wbGV0ZSkge1xuICAgICAgICAgIG1hdGNoZXMucHVzaChhKTtcbiAgICAgICAgICAvLy8vZHVtcChcIm1hdGNoOiBcIiArIGEgKyBcIlxcblwiKTtcbiAgICAgICAgICAvLyBpZiBubyBiZXN0IG1hdGNoLCB0aGlzIGlzIHRoZSBiZXN0IG1hdGNoXG4gICAgICAgICAgaWYoYmVzdG1hdGNoID09IG51bGwpXG4gICAgICAgICAge1xuICAgICAgICAgICAgYmVzdG1hdGNoID0gYTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0aGUgYmVzdCBtYXRjaCBpcyB0aGUgbG9uZ2VzdCBjb21tb24gc3RyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiBtaW4oYSxiKXsgcmV0dXJuICgoYTxiKT9hOmIpOyB9XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvcihpPTA7IGk8IG1pbihiZXN0bWF0Y2gubGVuZ3RoLCBhLmxlbmd0aCk7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWYoYmVzdG1hdGNoLmNoYXJBdChpKSAhPSBhLmNoYXJBdChpKSlcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJlc3RtYXRjaCA9IGJlc3RtYXRjaC5zdWJzdHIoMCxpKTtcbiAgICAgICAgICAgIC8vLy9kdW1wKFwiYmVzdG1hdGNoIGxlbjogXCIgKyBpICsgXCJcXG5cIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vLy9kdW1wKFwiYmVzdG1hdGNoOiBcIiArIGJlc3RtYXRjaCArIFwiXFxuXCIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBiZXN0bWF0Y2ggPSAoYmVzdG1hdGNoIHx8IFwiXCIpO1xuICAgICAgLy8vL2R1bXAoXCJtYXRjaGVzOiBcIiArIG1hdGNoZXMgKyBcIlxcblwiKTtcbiAgICAgIHZhciBvYmpBbmRDb21wbGV0ZSA9IChvYmpuYW1lIHx8IG9iaikgKyBcIi5cIiArIGJlc3RtYXRjaDtcbiAgICAgIC8vZHVtcChcIm1hdGNoZXMubGVuZ3RoOiBcIiArIG1hdGNoZXMubGVuZ3RoICsgXCIsIHRvb01hbnlNYXRjaGVzOiBcIiArIHRvb01hbnlNYXRjaGVzICsgXCIsIG9iakFuZENvbXBsZXRlOiBcIiArIG9iakFuZENvbXBsZXRlICsgXCJcXG5cIik7XG4gICAgICBpZihtYXRjaGVzLmxlbmd0aCA+IDEgJiYgKHRvb01hbnlNYXRjaGVzID09IG9iakFuZENvbXBsZXRlIHx8IG1hdGNoZXMubGVuZ3RoIDw9IDEwKSkge1xuXG4gICAgICAgIHByaW50V2l0aFJ1bmluKFwiTWF0Y2hlczogXCIsIG1hdGNoZXMuam9pbignLCAnKSwgXCJ0YWJjb21wbGV0ZVwiKTtcbiAgICAgICAgdG9vTWFueU1hdGNoZXMgPSBudWxsO1xuICAgICAgfVxuICAgICAgZWxzZSBpZihtYXRjaGVzLmxlbmd0aCA+IDEwKVxuICAgICAge1xuICAgICAgICBwcmludGxuKG1hdGNoZXMubGVuZ3RoICsgXCIgbWF0Y2hlcy4gIFByZXNzIHRhYiBhZ2FpbiB0byBzZWUgdGhlbSBhbGxcIiwgXCJ0YWJjb21wbGV0ZVwiKTtcbiAgICAgICAgdG9vTWFueU1hdGNoZXMgPSBvYmpBbmRDb21wbGV0ZTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB0b29NYW55TWF0Y2hlcyA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZihiZXN0bWF0Y2ggIT0gXCJcIilcbiAgICAgIHtcbiAgICAgICAgdmFyIHNzdGFydDtcbiAgICAgICAgaWYoZG90cG9zID09IGNhcmV0KSB7XG4gICAgICAgICAgc3N0YXJ0ID0gc3BhY2Vwb3MrMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBzc3RhcnQgPSBkb3Rwb3MrMTtcbiAgICAgICAgfVxuICAgICAgICBfaW4udmFsdWUgPSBfaW4udmFsdWUuc3Vic3RyKDAsIHNzdGFydClcbiAgICAgICAgICAgICAgICAgICsgYmVzdG1hdGNoXG4gICAgICAgICAgICAgICAgICArIF9pbi52YWx1ZS5zdWJzdHIoY2FyZXQpO1xuICAgICAgICBzZXRzZWxlY3Rpb250byhfaW4sY2FyZXQgKyAoYmVzdG1hdGNoLmxlbmd0aCAtIGNvbXBsZXRlLmxlbmd0aCkpO1xuICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcHJpbnRRdWVzdGlvbihxKVxue1xuICBwcmludGxuKHEsIFwiaW5wdXRcIik7XG59XG5cbmZ1bmN0aW9uIHByaW50QW5zd2VyKGEpXG57XG4gIGlmIChhICE9PSB1bmRlZmluZWQpIHtcbiAgICBwcmludGxuKGEsIFwibm9ybWFsT3V0cHV0XCIpO1xuICAgIHNoZWxsQ29tbWFuZHMuYW5zID0gYTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwcmludEVycm9yKGVyKVxue1xuICB2YXIgbGluZU51bWJlclN0cmluZztcblxuICBsYXN0RXJyb3IgPSBlcjsgLy8gZm9yIGRlYnVnZ2luZyB0aGUgc2hlbGxcbiAgaWYgKGVyLm5hbWUpXG4gIHtcbiAgICAvLyBsaW5lTnVtYmVyU3RyaW5nIHNob3VsZCBub3QgYmUgXCJcIiwgdG8gYXZvaWQgYSB2ZXJ5IHdhY2t5IGJ1ZyBpbiBJRSA2LlxuICAgIGxpbmVOdW1iZXJTdHJpbmcgPSAoZXIubGluZU51bWJlciAhPSB1bmRlZmluZWQpID8gKFwiIG9uIGxpbmUgXCIgKyBlci5saW5lTnVtYmVyICsgXCI6IFwiKSA6IFwiOiBcIjtcbiAgICBwcmludGxuKGVyLm5hbWUgKyBsaW5lTnVtYmVyU3RyaW5nICsgZXIubWVzc2FnZSwgXCJlcnJvclwiKTsgLy8gQmVjYXVzZSBJRSBkb2Vzbid0IGhhdmUgZXJyb3IudG9TdHJpbmcuXG4gIH1cbiAgZWxzZVxuICAgIHByaW50bG4oZXIsIFwiZXJyb3JcIik7IC8vIEJlY2F1c2Ugc2VjdXJpdHkgZXJyb3JzIGluIE1veiAvb25seS8gaGF2ZSB0b1N0cmluZy5cbn1cblxuZnVuY3Rpb24gZ28ocylcbntcbiAgX2luLnZhbHVlID0gcXVlc3Rpb24gPSBzID8gcyA6IF9pbi52YWx1ZTtcblxuICBpZiAocXVlc3Rpb24gPT0gXCJcIilcbiAgICByZXR1cm47XG5cbiAgaGlzdExpc3RbaGlzdExpc3QubGVuZ3RoLTFdID0gcXVlc3Rpb247XG4gIGhpc3RMaXN0W2hpc3RMaXN0Lmxlbmd0aF0gPSBcIlwiO1xuICBoaXN0UG9zID0gaGlzdExpc3QubGVuZ3RoIC0gMTtcblxuICAvLyBVbmZvcnR1bmF0ZWx5LCB0aGlzIGhhcyB0byBoYXBwZW4gKmJlZm9yZSogdGhlIEphdmFTY3JpcHQgaXMgcnVuLCBzbyB0aGF0XG4gIC8vIHByaW50KCkgb3V0cHV0IHdpbGwgZ28gaW4gdGhlIHJpZ2h0IHBsYWNlLlxuICBfaW4udmFsdWU9Jyc7XG4gIHJlY2FsY3VsYXRlSW5wdXRIZWlnaHQoKTtcbiAgcHJpbnRRdWVzdGlvbihxdWVzdGlvbik7XG5cbiAgaWYgKF93aW4uY2xvc2VkKSB7XG4gICAgcHJpbnRFcnJvcihcIlRhcmdldCB3aW5kb3cgaGFzIGJlZW4gY2xvc2VkLlwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB0cnkgeyAoXCJTaGVsbFwiIGluIF93aW4pIH1cbiAgY2F0Y2goZXIpIHtcbiAgICBwcmludEVycm9yKFwiVGhlIEphdmFTY3JpcHQgU2hlbGwgY2Fubm90IGFjY2VzcyB2YXJpYWJsZXMgaW4gdGhlIHRhcmdldCB3aW5kb3cuICBUaGUgbW9zdCBsaWtlbHkgcmVhc29uIGlzIHRoYXQgdGhlIHRhcmdldCB3aW5kb3cgbm93IGhhcyBhIGRpZmZlcmVudCBwYWdlIGxvYWRlZCBhbmQgdGhhdCBwYWdlIGhhcyBhIGRpZmZlcmVudCBob3N0bmFtZSB0aGFuIHRoZSBvcmlnaW5hbCBwYWdlLlwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIShcIlNoZWxsXCIgaW4gX3dpbikpXG4gICAgaW5pdFRhcmdldCgpOyAvLyBzaWxlbnRcblxuICAvLyBFdmFsdWF0ZSBTaGVsbC5xdWVzdGlvbiB1c2luZyBfd2luJ3MgZXZhbCAodGhpcyBpcyB3aHkgZXZhbCBpc24ndCBpbiB0aGUgfHdpdGh8LCBJSVJDKS5cbiAgX3dpbi5sb2NhdGlvbi5ocmVmID0gXCJqYXZhc2NyaXB0OnRyeXsgU2hlbGwucHJpbnRBbnN3ZXIoZXZhbCgnd2l0aChTaGVsbC5fc2NvcGUpIHdpdGgoU2hlbGwuc2hlbGxDb21tYW5kcykgeycgKyBTaGVsbC5xdWVzdGlvbiArIFN0cmluZy5mcm9tQ2hhckNvZGUoMTApICsgJ30nKSk7IH0gY2F0Y2goZXIpIHsgU2hlbGwucHJpbnRFcnJvcihlcik7IH07IHNldFRpbWVvdXQoU2hlbGwucmVmb2N1cywgMCk7IHZvaWQgMFwiO1xufVxuXG48L3NjcmlwdD5cblxuPCEtLSBmb3IgaHR0cDovL3RlZC5taWVsY3phcmVrLm9yZy9jb2RlL21vemlsbGEvZXh0ZW5zaW9uZGV2LyAtLT5cbjxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiIHNyYz1cImNocm9tZTovL2V4dGVuc2lvbmRldi9jb250ZW50L3JkZmhpc3RvcnkuanNcIj48L3NjcmlwdD5cbjxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiIHNyYz1cImNocm9tZTovL2V4dGVuc2lvbmRldi9jb250ZW50L2Nocm9tZVNoZWxsRXh0cmFzLmpzXCI+PC9zY3JpcHQ+XG5cbjxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cbiAgICBib2R5IHsgYmFja2dyb3VuZDogYmxhY2s7IGNvbG9yOiBibGFjazsgfVxuICAgIFxuICAgICNvdXRwdXQgeyB3aGl0ZS1zcGFjZTogcHJlOyB3aGl0ZS1zcGFjZTogLW1vei1wcmUtd3JhcDsgaGVpZ2h0OiA0NXZoOyBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMzcsIDM3LCAzNyk7IG92ZXJmbG93OiBhdXRvO30gLyogUHJlc2VydmUgbGluZSBicmVha3MsIGJ1dCB3cmFwIHRvbyBpZiBicm93c2VyIHN1cHBvcnRzIGl0ICovXG4gICAgaDMgeyBtYXJnaW4tdG9wOiAwOyBtYXJnaW4tYm90dG9tOiAwZW07IH1cbiAgICBoMyArIGRpdiB7IG1hcmdpbjogMDsgfVxuICAgIFxuICAgIGZvcm0geyBtYXJnaW46IDA7IHBhZGRpbmc6IDA7IH1cbiAgICAjaW5wdXQgeyB3aWR0aDogMTAwJTsgYm9yZGVyOiBub25lOyBwYWRkaW5nOiAwOyBvdmVyZmxvdzogYXV0bzsgYm9yZGVyLXN0eWxlOiBzb2xpZDsgYm9yZGVyLXdpZHRoOiAxcHg7IGhlaWdodDogMjUwcHg7IGJhY2tncm91bmQ6IGJsYWNrOyBib3JkZXItY29sb3I6IGdyZWVuO31cbiAgICAjaW5wdXQ6Zm9jdXMge1xuICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgwLCAyNTUsIDAsIDAuNTg5KTtcbiAgICB9XG4gICAgLmlucHV0IHsgY29sb3I6IGxpbWU7ICBmb250OiBpbmhlcml0OyBmb250LXdlaWdodDogYm9sZDsgbWFyZ2luLXRvcDogLjVlbTsgLyogYmFja2dyb3VuZDogI0U2RTZGRjsgKi8gfVxuICAgIC5ub3JtYWxPdXRwdXQgeyBjb2xvcjogbGltZTsgIH1cbiAgICAucHJpbnQgeyBjb2xvcjogcmdiKDAsIDE1NSwgMCk7ICB9XG4gICAgLmVycm9yIHsgY29sb3I6IHJlZDsgIG1hcmdpbi10b3A6IDVweDt9XG4gICAgLnByb3BMaXN0IHsgY29sb3I6IGdyZWVuOyAgfVxuICAgIC5tZXNzYWdlIHsgY29sb3I6IGdyZWVuOyAgfVxuICAgIC50YWJjb21wbGV0ZSB7IGNvbG9yOiBwdXJwbGU7ICB9XG4gICAgXG4gICAgXG4gICAgYm9keSB7XG4gICAgICAgIGNvbG9yOiBsaW1lO1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjaztcbiAgICAgICAgZm9udC1zaXplOiBsYXJnZTtcbiAgICAgICAgZm9udC1mYW1pbHk6ICc4Yml0JztcbiAgICB9XG4gICAgXG4gICAgLmJ0biB7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjaztcbiAgICAgIGNvbG9yOiBsaW1lO1xuICAgICAgYm9yZGVyLXN0eWxlOiBzb2xpZDtcbiAgICAgIGJvcmRlci1jb2xvcjogZ3JlZW47XG4gICAgICBwYWRkaW5nOiA0cHg7XG4gICAgICBtYXJnaW4tbGVmdDogNXB4O1xuICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgIH1cbiAgICAuYnRuOmhvdmVyIHtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IGxpbWU7XG4gICAgICBjb2xvcjogYmxhY2s7XG4gICAgfVxuICAgIFxuICAgIFxuICAgIFxuICAgIEBmb250LWZhY2Uge1xuICAgICAgZm9udC1mYW1pbHk6ICdDb25uMic7XG4gICAgICBzcmM6IHVybCgnLi4vQXNzZXRzL0ZvbnRzL0Nvbm5lY3Rpb25JaS0yd2o4Lm90ZicpO1xuICAgIH1cbiAgICBAZm9udC1mYWNlIHtcbiAgICAgIGZvbnQtZmFtaWx5OiAnOGJpdCc7XG4gICAgICBzcmM6IHVybCgnLi4vQXNzZXRzL0ZvbnRzL0RpYXJ5T2ZBbjhCaXRNYWdlLWxZREQudHRmJyk7XG4gICAgfVxuICAgIEBmb250LWZhY2Uge1xuICAgICAgZm9udC1mYW1pbHk6ICdDb21wdXRlcic7XG4gICAgICBzcmM6IHVybCgnLi4vQXNzZXRzL0ZvbnRzL0NvbXB1dGVyUGl4ZWw3LW1uTDIudHRmJyk7XG4gICAgfVxuICAgIEBmb250LWZhY2Uge1xuICAgICAgZm9udC1mYW1pbHk6ICdQaXhlbG9pZCc7XG4gICAgICBzcmM6IHVybCgnLi4vQXNzZXRzL0ZvbnRzL1BpeGVsb2lkTW9uby0xRzhhZS50dGYnKTtcbiAgICB9XG4gICAgPC9zdHlsZT5cbiIsIkJJRCI6IiJ9" });
ReloadItems();
